var game;window.onload=function(){setTimeout(function(){window.scrollTo(0,1);if(MainGame.isAPI)GamifiveSDK.init({lite:true});initGameStates()},100)};var MainGame={Config:{GAME_WIDTH:640,GAME_HEIGHT:960},isAPI:!true,isDebug:false,isGodMode:false,title:"galaga_v1.0",state:null,stateName:"",orientation:0,orientated:false,languages:["EN","IT","ES","PT","TR","DE","BR","RU","FR","JP","AR"],language:0,styleText:{font:"20px joystix",fill:"#ffffff"},styleText2:{font:"20px calibri",fill:"#ffffff"},styleText3:{font:"20px Hardpixel",fill:"#ffffff"},styleText4:{font:"20px ArialBold",fill:"#ffffff"},GAME_TEXT:null,TEXT_FILE:null,old_w:false,old_h:false,onDesktop:false,fadeColor:0,textFPS:null,showFPS:false,isPaused:false,isGoAway:false,isMusicMuted:false,isMusicPlaying:-1,nextState:"",gameOver:false,firstLoad:true,firstTime:true,firstGo:true,highScore:100,controlMode:0,initSettings:function(){game.input.maxPointers=1;game.stage.disableVisibilityChange=true;game.load.crossOrigin="anonymous";game.stage.smoothed=false;game.add.text(0,0,"0123456789",MainGame.styleText).destroy();game.add.text(0,0,"0123456789",MainGame.styleText2).destroy();game.add.text(0,0,"0123456789",MainGame.styleText3).destroy();game.add.text(0,0,"0123456789",MainGame.styleText4).destroy();game.camera.onFadeComplete.add(MainGame.changeState,this);MainGame.worldX=game.world.centerX;MainGame.worldY=game.world.centerY;MainGame.loadSaves();MainGame.midX=Math.ceil(MainGame.Config.GAME_WIDTH/2);if(game.device.desktop){game.canvas.oncontextmenu=function(e){e.preventDefault()};window.addEventListener("keydown",function(e){if([32,37,38,39,40].indexOf(e.keyCode)>-1){e.preventDefault()}},false)}},continueGame:function(){game.state.start("Menu")},addButton:function(link,vLayer,vX,vY,onClick,vText,vW,vH,vSize){if(typeof vW==="undefined")vW=200;if(typeof vH==="undefined")vH=80;if(typeof vSize==="undefined")vSize=36;var btn=MainGame.addFill(vLayer,3355443,0,vW,vH,vX-vW/2,vY-vH/2);btn.inputEnabled=true;btn.events.onInputDown.add(onClick,link);btn.text=MainGame.addText(1,vX,vY,vText,vLayer,vSize,"#FFFFFF",.5,.5);return btn},addText:function(vT,vX,vY,vText,vLayer,vSize,vColor,vAnchorX,vAnchorY,vStyle){if(typeof vLayer==="undefined")vLayer="";if(typeof vSize==="undefined")vSize=40;if(typeof vColor==="undefined")vColor="#000000";if(typeof vAnchorX==="undefined")vAnchorX=0;if(typeof vAnchorY==="undefined")vAnchorY=0;if(typeof vStyle==="undefined"){if(vT==0){vStyle=MainGame.styleText}else{vStyle=MainGame.styleText;if(MainGame.languages[MainGame.language]=="RU")vStyle=MainGame.styleText3;if(MainGame.languages[MainGame.language]=="AR"||MainGame.languages[MainGame.language]=="JP"||MainGame.languages[MainGame.language]=="DE")vStyle=MainGame.styleText4}}var text;if(vLayer!=""){text=vLayer.add(game.add.text(vX,vY,vText,vStyle))}else{text=game.add.text(vX,vY,vText,vStyle)}text.anchor.setTo(vAnchorX,vAnchorY);text.fontSize=vSize;text.fill=vColor;return text},updateTextWidth:function(vText,vMaxWidth){var _txtWidth=vText.width;var scale=1;if(_txtWidth>vMaxWidth){scale=vMaxWidth/_txtWidth;vText.scale.setTo(scale)}return scale},addPanelka:function(vLayer,vX,vY,vW,vH,vColorF,vColorB,vLine){if(typeof vColorF==="undefined")vColorF=0;if(typeof vColorB==="undefined")vColorB=16777215;if(typeof vLine==="undefined")vLine=4;var graphics=vLayer.add(game.add.graphics(vX,vY));graphics.lineStyle(vLine,vColorB,.6);graphics.beginFill(vColorF,.7);graphics.drawRect(0,0,vW,vH);graphics.endFill();return graphics},loadSaves:function(){if(MainGame.isAPI)GamifiveSDK.loadUserData(this.dataIsLoaded)},dataIsLoaded:function(data){if(data.game!=MainGame.title+"_v1.0"){if(MainGame.isAPI)GamifiveSDK.clearUserData();return}if(data.language!=null)MainGame.language=data.language;MainGame.highScore=data.highScore},saveSaves:function(){var playerProgress={game:MainGame.title+"_v1.0",language:MainGame.language,highScore:MainGame.highScore};if(MainGame.isAPI)GamifiveSDK.saveUserData(playerProgress)},clearSaves:function(){if(MainGame.isAPI)GamifiveSDK.clearUserData()},clearGame:function(){game.tweens.removeAll()},goToState:function(pNextState){MainGame.isFadeGame=false;MainGame.clearGame();game.camera.fade(MainGame.fadeColor,200);MainGame.nextState=pNextState},changeState:function(){if(!MainGame.isFadeGame)game.state.start(MainGame.nextState)},fadeOut:function(){game.camera.flash(MainGame.fadeColor,200)},resizeGame:function(){var ratio=window.innerWidth/window.innerHeight;var standardWidth=640;var standardHeight=960;var maxWidth=1920;var standardRatio=standardWidth/standardHeight;if(ratio>standardRatio){game.scale.setGameSize(Math.min(maxWidth,Math.ceil(standardHeight*ratio)),standardHeight);game.world.setBounds(Math.ceil((game.width-standardWidth)*-.5),0,game.width,game.height)}else{game.scale.setGameSize(standardWidth,standardHeight);game.world.setBounds(0,0,Math.ceil((game.height-standardHeight)*-.5),game.height)}},muteSounds:function(btn){},playMusic:function(num){},stopMusic:function(){},playSound:function(vNum){if(game.device.webAudio){MainGame["s_sounds"+vNum].play()}else{if(vNum==13)MainGame["s_sounds"+vNum].play()}},showFps:function(vX,vY){if(typeof vX==="undefined")vX=20;if(typeof vY==="undefined")vY=20;game.time.advancedTiming=true;MainGame.textFPS=game.add.text(vX,vY,"FPS",{font:"20px Arial",fill:"#FFFFFF",align:"center"});MainGame.textFPS.fixedToCamera=true},clickLogo:function(vMoreGames){if(typeof vMoreGames==="undefined")vMoreGames=true;if(MainGame.clickOne)return;try{if(MainGame.isAPI)GamifiveSDK.goToHome()}catch(err){console.log(err)}MainGame.clickOne=true;game.time.events.add(500,MainGame.clickOneBack,this)},clickOneBack:function(){MainGame.clickOne=false},addFill:function(vLayer,vColor,vAlpha,vW,vH,posX,posY){if(typeof vAlpha==="undefined")vAlpha=1;if(typeof posX==="undefined")posX=0;if(typeof posY==="undefined")posY=0;if(typeof vW==="undefined"){vW=game.width;posX=-vW/2}if(typeof vH==="undefined"){vH=game.height}var bg=vLayer.add(game.add.graphics(posX,posY));bg.beginFill(vColor,vAlpha);bg.drawRect(0,0,vW,vH);bg.endFill();return bg}};KeyButton=function(game,link,kuda,x,y,callback,spritesheet,frame1,frame2,vText,vStyle,vFrameName,vId){if(typeof vText==="undefined")vText="";if(typeof vStyle==="undefined")vStyle=MainGame.styleText;if(typeof vFrameName==="undefined")vFrameName="";if(typeof vId==="undefined")vId="";_game=game;if(kuda==null){this.buttonC=game.add.group()}else{this.buttonC=kuda.add(game.add.group())}this.buttonC.x=x;this.buttonC.y=y;this.button=this.buttonC.add(game.add.button(0,0,spritesheet,callback,link,frame1,frame2,frame1,frame2));this.button.game=_game;this.button.anchor.setTo(.5,.5);this.button.inputEnabled=true;this.button.textKey=vText;if(_game.device.desktop)this.button.input.useHandCursor=true;if(vText!=""){var text=this.buttonC.add(game.add.text(0,2,vText.toUpperCase(),vStyle));text.anchor.set(.5);this.text=text}else{if(vFrameName!=""){var text=this.buttonC.add(_game.add.sprite(0,-2,spritesheet,vFrameName));text.anchor.set(.5)}this.button.textKey=vId}this.button.events.onInputDown.add(function(){_game.add.tween(this.buttonC.scale).to({x:.9,y:.9},200,Phaser.Easing.Cubic.Out,true);_game.add.tween(this.buttonC.scale).to({x:1,y:1},200,Phaser.Easing.Cubic.Out,true,260)},this)};SimpleButton=function(game,link,kuda,x,y,key,frame,callback,animationScale,vText,vDx,vDy,vStyle,vIsUpperCase){if(typeof vText==="undefined")vText="";if(typeof vDx==="undefined")vDx=0;if(typeof vDy==="undefined")vDy=0;if(typeof animationScale==="undefined")animationScale=0;if(typeof vStyle==="undefined")vStyle=MainGame.styleText;if(typeof vIsUpperCase==="undefined")vIsUpperCase=true;_game=game;if(kuda==null){this.buttonC=game.add.group()}else{this.buttonC=kuda.add(game.add.group())}this.buttonC.x=x;this.buttonC.y=y;this.button=this.buttonC.add(_game.add.sprite(0,0,key,frame));this.button.game=_game;this.button.anchor.setTo(.5,.5);this.button.inputEnabled=true;if(vText!=""){if(vIsUpperCase)vText=vText.toUpperCase();var text=this.buttonC.add(game.add.text(0+vDx,0+vDy,vText,vStyle));text.anchor.set(.5);this.text=text}this.button.events.onInputDown.add(function(){if(this.buttonC.alpha<1)return;_game.add.tween(this.buttonC.scale).to({x:.9,y:.9},200,Phaser.Easing.Cubic.Out,true);_game.add.tween(this.buttonC.scale).to({x:1,y:1},200,Phaser.Easing.Cubic.Out,true,260);_game.time.events.add(250,callback,link)},this);if(animationScale>1){_game.add.tween(this.buttonC.scale).to({x:animationScale,y:animationScale},630,Phaser.Easing.Linear.None).to({x:1,y:1},630,Phaser.Easing.Linear.None).loop().start()}};var MyKeyboard={initKeyboard:function(vX,vY,vLayer,vTextField){this.arrKeys=[];var posY=0;var posX=0;var sdvigX=vX;var btn;for(var i=0;i<36;i++){if(i==10||i==20||i==29){posY++;posX=0;if(posY==1)sdvigX=vX+22.5;if(posY==2)sdvigX=vX+45;if(posY==3)sdvigX=vX+45+45}btn=new KeyButton(game,this,vLayer,sdvigX+45*posX++,vY+45*posY,this.keyPressVirutal,"ss_main","btn_key_miniOver_0000","btn_key_miniUp_0000",MainGame.keyboardKeys[i],MainGame.styleTextKey);this.arrKeys.push(btn)}btn=new KeyButton(game,this,vLayer,vX+45*10,vY,this.keyPressVirutal,"ss_main","btn_key_miniOver_0000","btn_key_miniUp_0000","",MainGame.styleTextKey,"symbol_arrow_0000","bspace");this.arrKeys.push(btn);MainGame.keyboardField=vTextField;MainGame.keyboardArrKeys=this.arrKeys;MainGame.keyboardActivated=true},keyPressVirutal:function(vKey){var ch=vKey.textKey;if(ch=="bspace"){this.removeBukva()}else if(ch=="space"){this.addBukva(" ")}else{this.addBukva(ch.toUpperCase())}},addBukva:function(vChar){str=MainGame.keyboardField.text;strl=str.length;if(strl>=MainGame.MAX_LENGTH)return;if(strl==0&&vChar==" ")return;MainGame.keyboardField.setText(MainGame.keyboardField.text+vChar)},removeBukva:function(){str=MainGame.keyboardField.text;strl=str.length;if(strl<1)return;newstr=MainGame.keyboardField.text.substring(0,strl-1);MainGame.keyboardField.setText(newstr)},tweenBtn:function(vBtn){game.add.tween(vBtn.scale).to({x:.9,y:.9},200,Phaser.Easing.Cubic.Out,true);game.add.tween(vBtn.scale).to({x:1,y:1},200,Phaser.Easing.Cubic.Out,true,260)}};var MyMath={getRandomInt:function(min,max){return Math.floor(Math.random()*(max-min+1))+min},getRandomBool:function(){return Math.random()<.5?true:false},shuffleArr:function(o){for(var j,x,i=o.length;i;j=Math.floor(Math.random()*i),x=o[--i],o[i]=o[j],o[j]=x);return o},distanceTwoPoints:function(x1,x2,y1,y2){var dx=x1-x2;var dy=y1-y2;return dx*dx+dy*dy},parseQuery:function(qstr){var query={};var a=qstr.substr(1).split("&");for(var i=0;i<a.length;i++){var b=a[i].split("=");query[decodeURIComponent(b[0])]=decodeURIComponent(b[1]||"")}return query},lerp:function(in_Src,in_Dst,in_Ratio){return in_Src*(1-in_Ratio)+in_Dst*in_Ratio}};function initGameStates(){game=new Phaser.Game(MainGame.Config.GAME_WIDTH,MainGame.Config.GAME_HEIGHT,Phaser.AUTO,"game-container");game.state.add("Boot",MainGame.Boot,true);game.state.add("Preloader",MainGame.Preloader);game.state.add("Menu",MainGame.Menu);game.state.add("Game",MainGame.Game);setTimeout(function(){window.scrollTo(0,1)},100)}function trace(a){console.log(a)}MainGame.Boot=function(game){};MainGame.Boot.prototype={init:function(){game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL;game.scale.fullScreenScaleMode=Phaser.ScaleManager.SHOW_ALL;game.scale.setResizeCallback(this.resizeGame);game.scale.pageAlignHorizontally=true;if(game.device.desktop){MainGame.onDesktop=true}else{game.scale.pageAlignVertically=true;game.scale.forceLandscape=true;if(MainGame.orientation==0){game.scale.forceOrientation(false,true)}else{game.scale.forceOrientation(true,false)}game.scale.enterIncorrectOrientation.add(this.enterIncorrectOrientation,this);game.scale.leaveIncorrectOrientation.add(this.leaveIncorrectOrientation,this);game.scale.onOrientationChange.add(this.changeOrientation,this)}game.onPause.add(this.onGamePause,this);game.onResume.add(this.onGameResume,this);MainGame.initSettings()},resizeGame:function(){if(MainGame.old_w!=window.innerWidth||MainGame.old_h!=window.innerHeight){MainGame.old_w=window.innerWidth;MainGame.old_h=window.innerHeight;MainGame.resizeGame()}},preload:function(){this.load.image("backpreloader","assets/backpreloader.png?r=1");this.load.image("preloader_bar","assets/preloader_bar.png?r=1");this.load.image("preloader_back","assets/preloader_back.png?r=1")},create:function(){this.state.start("Preloader")},onGamePause:function(){if(!game.sound.mute){MainGame.isGoAway=true;game.sound.mute=true}else{MainGame.isGoAway=false}},onGameResume:function(){if(MainGame.isGoAway){game.sound.mute=false}},enterIncorrectOrientation:function(){setTimeout(function(){window.scrollTo(0,1)},100);MainGame.orientated=false;document.getElementById("orientation").style.display="block";if(!game.device.android){document.getElementById("orientation").style.width=window.innerWidth+"px";document.getElementById("orientation").style.height=window.innerHeight+"px"}},leaveIncorrectOrientation:function(){MainGame.orientated=true;if(MainGame.loadIncorrect)window.location.reload();document.getElementById("orientation").style.display="none"},changeOrientation:function(){}};MainGame.Preloader=function(game){this.background=null;this.preloadBar=null;this.ready=false};MainGame.Preloader.prototype={preload:function(){game.stage.backgroundColor="#000000";var bg=game.add.sprite(MainGame.worldX,MainGame.worldY,"backpreloader");bg.anchor.setTo(.5,.5);var width=Math.ceil(412/2);this.background=game.add.sprite(MainGame.worldX-width,MainGame.worldY+200,"preloader_back");this.preloadBar=game.add.sprite(MainGame.worldX-width,MainGame.worldY+200,"preloader_bar");game.load.setPreloadSprite(this.preloadBar);game.load.image("bandai_logo","assets/bandai_logo.png?r=1");game.load.atlasJSONHash("ss_main","assets/spritesheets/ss_main.png?r="+MyMath.getRandomInt(0,99),"assets/spritesheets/ss_main.json?r="+MyMath.getRandomInt(0,99));game.load.atlasJSONHash("ss_menu","assets/spritesheets/ss_menu.png?r="+MyMath.getRandomInt(0,99),"assets/spritesheets/ss_menu.json?r="+MyMath.getRandomInt(0,99));game.load.audio("13_fightershot1",["assets/audio/ogg/13_fightershot1.ogg","assets/audio/mp3/13_fightershot1.mp3"]);if(game.device.webAudio){game.load.audio("02_start_music",["assets/audio/ogg/02_start_music.ogg","assets/audio/mp3/02_start_music.mp3"]);game.load.audio("21_stage_flag",["assets/audio/ogg/21_stage_flag.ogg","assets/audio/mp3/21_stage_flag.mp3"]);game.load.audio("22_miss",["assets/audio/ogg/22_miss.ogg","assets/audio/mp3/22_miss.mp3"]);game.load.audio("23_name_entry1",["assets/audio/ogg/23_name_entry1.ogg","assets/audio/mp3/23_name_entry1.mp3"]);game.load.audio("24_name_entry2",["assets/audio/ogg/24_name_entry2.ogg","assets/audio/mp3/24_name_entry2.mp3"]);game.load.audio("04_alien_flying",["assets/audio/ogg/04_alien_flying.ogg","assets/audio/mp3/04_alien_flying.mp3"]);game.load.audio("05_zako_stricken",["assets/audio/ogg/05_zako_stricken.ogg","assets/audio/mp3/05_zako_stricken.mp3"]);game.load.audio("06_goei_stricken",["assets/audio/ogg/06_goei_stricken.ogg","assets/audio/mp3/06_goei_stricken.mp3"]);game.load.audio("07_boss_stricken1",["assets/audio/ogg/07_boss_stricken1.ogg","assets/audio/mp3/07_boss_stricken1.mp3"]);game.load.audio("08_boss_stricken2",["assets/audio/ogg/08_boss_stricken2.ogg","assets/audio/mp3/08_boss_stricken2.mp3"]);game.load.audio("09_triple_formation",["assets/audio/ogg/09_triple_formation.ogg","assets/audio/mp3/09_triple_formation.mp3"]);game.load.audio("10_tractor_shot",["assets/audio/ogg/10_tractor_shot.ogg","assets/audio/mp3/10_tractor_shot.mp3"]);game.load.audio("11_tractor_capture",["assets/audio/ogg/11_tractor_capture.ogg","assets/audio/mp3/11_tractor_capture.mp3"]);game.load.audio("14_rescue_ship",["assets/audio/ogg/14_rescue_ship.ogg","assets/audio/mp3/14_rescue_ship.mp3"]);game.load.audio("16_mistake_ship",["assets/audio/ogg/16_mistake_ship.ogg","assets/audio/mp3/16_mistake_ship.mp3"])}game.load.json("alltext","assets/text/text.json?r="+MyMath.getRandomInt(0,99));game.add.text(0,0,"0123456789",MainGame.styleText).destroy()},create:function(){MainGame.TEXT_FILE=game.cache.getJSON("alltext");MainGame.s_sounds13=game.add.audio("13_fightershot1",1);if(game.device.webAudio){MainGame.s_sounds2=game.add.audio("02_start_music",1);MainGame.s_sounds21=game.add.audio("21_stage_flag",1);MainGame.s_sounds22=game.add.audio("22_miss",1);MainGame.s_sounds23=game.add.audio("23_name_entry1",1);MainGame.s_sounds24=game.add.audio("24_name_entry2",1);MainGame.s_sounds4=game.add.audio("04_alien_flying",1);MainGame.s_sounds5=game.add.audio("05_zako_stricken",1);MainGame.s_sounds6=game.add.audio("06_goei_stricken",1);MainGame.s_sounds7=game.add.audio("07_boss_stricken1",1);MainGame.s_sounds8=game.add.audio("08_boss_stricken2",1);MainGame.s_sounds9=game.add.audio("09_triple_formation",1);MainGame.s_sounds10=game.add.audio("10_tractor_shot",1);MainGame.s_sounds11=game.add.audio("11_tractor_capture",1);MainGame.s_sounds14=game.add.audio("14_rescue_ship",1);MainGame.s_sounds16=game.add.audio("16_mistake_ship",1)}},update:function(){if(!this.ready){this.ready=true;MainGame.continueGame()}}};Bot=function(game,vLayer,vType,vStrikeFunction){this.game=game;this.type=vType;var obj=vLayer.add(game.add.sprite(0,0,"ss_main"));obj.anchor.setTo(.5,.5);this.max_health=1;this.score1=160;this.score2=160;if(vType==1){this.max_health=2;obj.animations.add("idle2",Phaser.Animation.generateFrameNames("mob"+vType+"_idle2_",0,29,"",4),30);this.score1=150;this.score2=400}else if(vType==2||vType==3){obj.animations.add("transform1",Phaser.Animation.generateFrameNames("mob"+vType+"_transform_",0,29,"",4),30);obj.animations.add("transform2",Phaser.Animation.generateFrameNames("mob"+vType+"_transform2_",0,29,"",4),30);obj.animations.add("mob_t1",Phaser.Animation.generateFrameNames("mob4_idle_",0,29,"",4),30);obj.animations.add("mob_t2",Phaser.Animation.generateFrameNames("mob5_idle_",0,29,"",4),30);obj.animations.add("mob_t3",Phaser.Animation.generateFrameNames("mob6_idle_",0,29,"",4),30);if(vType==2){this.score1=80;this.score2=160}else{this.score1=50;this.score2=100}}if(vType==100){obj.animations.add("idle",Phaser.Animation.generateFrameNames("ship_red_",0,0,"",4),30);this.score1=1e3;this.score2=1e3}else{obj.animations.add("idle",Phaser.Animation.generateFrameNames("mob"+vType+"_idle_",0,29,"",4),30)}obj.animations.currentAnim.stop();obj.animations.currentAnim.frame=0;obj.anchor.setTo(.5,.5);this.obj=obj;this.obj.link=this;this.killed=false;this.aim={x:0,y:0};this.strikeAlienBullet=vStrikeFunction};Bot.prototype.reset=function(){this.MATH_PI=3.1415;this.x=null;this.y=null;this.color=null;this.v=null;this.theta=null;this.cosine=null;this.sine=null;this.dt=0;this.dtheta=0;this.leader=null;this.formation_offset=null;this.cur_pattern=null;this.cur_cmd=0;this.alive=true;this.goToAim=false;this.go=false;this.locked=false;this.typeAttack=0;this.isAngry=0;this.isCapturing=false;this.status=0;this.isAttacking=false;this.isPrilet=true;this.obj.visible=false;this.health=this.max_health;this.speed=8;this.isTransformation=0;this.isTempMob=false;this.tick=0;this.hasRedShip=null;this.goSamAttack=false;this.partyNum=0;this.isHasBullet=true;this.isAdded=false};Bot.prototype.updateAnimation=function(vBool){if(this.health==0||!this.alive){this.remove();return}if(!this.isPrilet||this.isTempMob){if(this.x<-50||this.x>690){if(this.isTransformation>0){this.remove();return}this.y=-50;this.x=320;this.goToAim=true}}if(this.isCapturing||this.isTransformation>0||this.isTempMob)return;if(vBool){this.obj.animations.currentAnim.frame=0}else{this.obj.animations.currentAnim.frame=20}};Bot.prototype.setAim=function(vAimX,vAimY){this.aim.x=vAimX;this.aim.y=vAimY};Bot.prototype.setPos=function(x,y){this.x=x;this.y=y;this.obj.x=this.x;this.obj.y=this.y};Bot.prototype.setVelocity=function(v){this.v=v};Bot.prototype.setFormationOffset=function(offset){this.formation_offset=offset};Bot.prototype.setDir=function(theta){this.theta=theta;this.obj.angle=90+Phaser.Math.radToDeg(this.theta)};Bot.prototype.setPatternQueue=function(patternQueue){this.cur_pattern=patternQueue[0];this.cur_cmd=0};Bot.prototype.mirror=function(){this.theta=this.leader.theta;this.x=this.formation_offset*-this.leader.sine+this.leader.x;this.y=this.formation_offset*this.leader.cosine+this.leader.y};Bot.prototype.updateGridPosition=function(vSdvigX){if(!this.isTempMob)this.aim.x+=vSdvigX;if(this.locked){this.x+=vSdvigX;this.obj.x=this.x}};Bot.prototype.updateBeatPosition=function(vSdvigX){if(this.type==1)return;if(!this.isTempMob)this.aim.x+=vSdvigX*this.indX;if(this.locked){this.x=this.aim.x;this.obj.x=this.x}};Bot.prototype.setSide=function(vIndX){this.indX=vIndX;switch(this.type){case 1:if(vIndX>0){this.patternSide=0;this.wayAttack1=PATTERNS.attack_M3_A1_R;this.wayAttack2=PATTERNS.attack_M3_A2_R;this.wayAttack3=PATTERNS.attack_M3_A3_R}else{this.patternSide=1;this.wayAttack1=PATTERNS.attack_M3_A1_L;this.wayAttack2=PATTERNS.attack_M3_A2_L;this.wayAttack3=PATTERNS.attack_M3_A3_L}break;case 2:if(vIndX>0){this.patternSide=0;this.wayAttack1=PATTERNS.attack_M2_A1_R;this.wayAttack2=PATTERNS.attack_M2_A2_R}else{this.patternSide=1;this.wayAttack1=PATTERNS.attack_M2_A1_L;this.wayAttack2=PATTERNS.attack_M2_A2_L}break;case 3:if(vIndX>0){this.patternSide=0;this.wayAttack1=PATTERNS.attack_M1_A1_R;this.wayAttack2=PATTERNS.attack_M1_A2_R}else{this.patternSide=1;this.wayAttack1=PATTERNS.attack_M1_A1_L;this.wayAttack2=PATTERNS.attack_M1_A2_L}break}};Bot.prototype.goFly=function(){this.obj.visible=true;this.go=true;this.isAdded=true};Bot.prototype.showId=function(){MainGame.addText(this.obj.x+3,this.obj.y+3,this.id,"",24,"#00FF00")};Bot.prototype.goAttackWithBoss=function(vWay){if(this.go||this.isCapturing||this.health==0)return;this.cur_pattern=vWay;this.cur_cmd=0;this.goToAim=false;this.go=true;this.locked=false;this.isAttacking=true};Bot.prototype.isLive=function(){return this.health>0};Bot.prototype.goPasanu=function(){var arCanHelp=[];var arHelpers=[];var ship;switch(this.id){case 8:arHelpers=[19,9,4];break;case 10:arHelpers=[9,4,5];break;case 12:arHelpers=[4,5,11];break;case 14:arHelpers=[5,11,16];break}for(var i=0;i<3;i++){ship=MainGame.state.findShipById(arHelpers[i]);if(ship!=null&&ship.isLive())arCanHelp.push(ship)}this.score2=400;if(arCanHelp.length>0){arCanHelp[0].goAttackWithBoss(this.cur_pattern);this.score2=800}if(arCanHelp.length>1){arCanHelp[1].goAttackWithBoss(this.cur_pattern);this.score2=1600}if(this.hasRedShip!=null){this.hasRedShip.goAttackWithBoss(this.cur_pattern)}};Bot.prototype.goAttack=function(vIsTransform){if(this.go||this.isCapturing||this.health==0)return;if(this.type==1){this.typeAttack=MyMath.getRandomInt(0,1);if(MainGame.state.isDoubleShip||MainGame.state.isRedShip||MainGame.state.isWaving||MainGame.state.isPanic)this.typeAttack=0;if(this.typeAttack==0){if(MyMath.getRandomBool()){this.cur_pattern=PATTERNS.attack_M3_A1_R[0];this.patternSide=0}else{this.cur_pattern=PATTERNS.attack_M3_A1_L[0];this.patternSide=1}this.goPasanu()}else{this.goCapture();this.typeAttack=0;return}}else{this.cur_pattern=this.wayAttack1[0];if(vIsTransform)this.goTransform()}this.tick=0;this.cur_cmd=0;this.goToAim=false;this.isAttacking=true;if(!vIsTransform){this.locked=false;this.go=true;MainGame.playSound(4)}};Bot.prototype.goTransform=function(vTime,vNum){MainGame.playSound(9);var typeTransform=MyMath.getRandomInt(1,3);this.isTransformation=typeTransform;switch(typeTransform){case 1:this.obj.play("transform1");break;case 2:this.obj.play("transform1");break;case 3:this.obj.play("transform2");break}this.obj.events.onAnimationComplete.add(this.onAnimComplete,this)};Bot.prototype.transformBack=function(){this.isTransformation=0;this.obj.play("idle");if(this.type==2){this.score1=80;this.score2=160}else{this.score1=50;this.score2=100}this.partyNum=0};Bot.prototype.onAnimComplete=function(sprite,animation){if(animation.name=="transform1"||animation.name=="transform2"){switch(this.isTransformation){case 1:this.partyNum=game.time.now;this.obj.play("mob_t2");this.game.time.events.add(400,this.addScorpion,this,this.partyNum,90).autoDestroy=true;this.game.time.events.add(400,this.addScorpion,this,this.partyNum,50+90*2).autoDestroy=true;this.score1=160;this.score2=160;break;case 2:this.partyNum=game.time.now;this.obj.play("mob_t3");this.game.time.events.add(300,this.addMuha,this,this.partyNum,130).autoDestroy=true;this.game.time.events.add(300,this.addMuha,this,this.partyNum,130*2).autoDestroy=true;this.score1=160;this.score2=160;break;case 3:this.partyNum=game.time.now;this.obj.play("mob_t1");var _aimX=320+25*MyMath.getRandomInt(-20,20);this.game.time.events.add(450,this.addYellowFlags,this,this.partyNum,_aimX,0).autoDestroy=true;this.game.time.events.add(450,this.addYellowFlags,this,this.partyNum,_aimX,40).autoDestroy=true;this.score1=160;this.score2=160;break}this.locked=false;this.go=true}};Bot.prototype.addScorpion=function(vPartyNum,vTick){var aimX;if(this.patternSide==1){aimX=320+150}else{aimX=320-150}var obj=MainGame.state.addAlien(5,-this.MATH_PI/2,this.aim.x,this.aim.y,this.patternSide,aimX,1e3,this.tick,vTick);obj.partyNum=vPartyNum;obj.isTransformation=1;obj.type=3};Bot.prototype.addMuha=function(vPartyNum,vTick){var aimX;if(this.patternSide==1){aimX=320+150}else{aimX=320-150}var obj=MainGame.state.addAlien(6,-this.MATH_PI/2,this.aim.x,this.aim.y,this.patternSide,aimX,1e3,this.tick,vTick,this);obj.partyNum=vPartyNum;obj.isTransformation=2;obj.type=3};Bot.prototype.addYellowFlags=function(vPartyNum,vAimX,vDelta){var _x=this.x+Math.cos(this.theta)*vDelta;var _y=this.y+Math.sin(this.theta)*vDelta;var obj=MainGame.state.addAlien(4,this.theta,_x,_y,this.patternSide,vAimX,1e3);obj.partyNum=vPartyNum;obj.isTransformation=3;obj.type=3};Bot.prototype.goStrike=function(vTime){if(this.health<1)return;this.game.time.events.add(vTime,this.strikeAlienBullet,this,this.obj).autoDestroy=true};Bot.prototype.goAngry=function(){this.isAngry=1};Bot.prototype.goAttackAngry=function(){this.isAngry=2;if(this.type==1){if(this.patternSide==0){this.cur_pattern=PATTERNS.attack_M3_A2_R[0]}else{this.cur_pattern=PATTERNS.attack_M3_A2_L[0]}}else{this.cur_pattern=this.wayAttack2[0]}this.cur_cmd=0;this.goToAim=false;this.go=true;this.locked=false};Bot.prototype.goCapture=function(){if(this.go||this.isCapturing||this.health==0)return;if(MyMath.getRandomBool()){this.cur_pattern=PATTERNS.attack_M3_A3_R[0];this.patternSide=0}else{this.cur_pattern=PATTERNS.attack_M3_A3_L[0];this.patternSide=1}this.cur_cmd=0;this.goToAim=false;this.go=true;this.isCapturing=true;this.locked=false;MainGame.playSound(4)};Bot.prototype.goWave=function(){this.go=false;this.theta=this.MATH_PI/2;this.obj.angle=90+Phaser.Math.radToDeg(this.theta);this.status=0;this.obj.animations.currentAnim.stop();this.obj.animations.currentAnim.frame=20;this.timeWaving=game.time.events.repeat(200,28,this.goWaving,this)};Bot.prototype.moveBackToBase=function(){if(this.patternSide==0){this.cur_pattern=PATTERNS.wayBack_L[0]}else{this.cur_pattern=PATTERNS.wayBack_R[0]}this.cur_cmd=0;this.goToAim=false;this.go=true};Bot.prototype.goWaving=function(){this.status++;if(this.status==1){MainGame.state.updateWaveStatus(1,this.obj.x,this.obj.y)}else if(this.status==20){MainGame.state.updateWaveStatus(2)}else if(this.status==28){MainGame.state.updateWaveStatus(3);this.isCapturing=false;this.go=true;this.stopWaving()}if(this.status>=8&&this.status<19){MainGame.state.checkWaves(this.obj)}};Bot.prototype.getLoot=function(){this.isCapturing=false;MainGame.state.updateWaveStatus(4,this.x,this.y)};Bot.prototype.stopWaving=function(){this.game.time.events.remove(this.timeWaving)};Bot.prototype.getDamage=function(){if(!this.alive||!this.isAdded)return;this.health--;if(this.health<=0)this.alive=false;if(this.type==1){if(this.health==1){this.obj.play("idle2");MainGame.playSound(7)}else{MainGame.playSound(8);if(this.hasRedShip!=null){MainGame.state.killedCapture(this.go);MainGame.state.whoCaptureUs=null;this.hasRedShip.goSamAttack=true}if(this.isCapturing&&this.status>=0&&this.status<20)this.status=19}}else if(this.type==100){MainGame.state.isRedShip=false;MainGame.state.redShip=null;MainGame.playSound(16)}else if(this.type==3){if(this.isTransformation==0){MainGame.playSound(5)}else{MainGame.playSound(7)}}else if(this.type==2){if(this.isTransformation==0){MainGame.playSound(6)}else{MainGame.playSound(7)}}};Bot.prototype.update=function(vSpeed){if(!this.go)return;if(this.goToAim){if(!this.alive){this.remove();return}var yDistance=this.aim.y-this.y;var xDistance=this.aim.x-this.x;if(Math.sqrt(yDistance*yDistance+xDistance*xDistance)<8*vSpeed){if(!this.isTempMob){if(this.isPrilet)this.isPrilet=false;this.locked=true;this.x=this.aim.x;this.y=this.aim.y;if(this.isAttacking){if(this.theta>-1.57){this.theta-=.12}else{this.theta=-this.MATH_PI/2;this.go=false}}else{this.theta=-this.MATH_PI/2;this.go=false}if(this.isCapturing)this.getLoot();if(this.isTransformation>0)this.transformBack()}else{if(this.type==100){if(this.goSamAttack){MainGame.state.isRedShip=false;MainGame.state.redShip=null;this.remove();return}else{if(this.theta>-1.57){this.theta-=.12}else{this.theta=-this.MATH_PI/2;this.go=false}}}else{this.remove();return}}}else{var radian=Math.atan2(yDistance,xDistance);this.x+=Math.cos(radian)*this.speed*vSpeed;this.y+=Math.sin(radian)*this.speed*vSpeed;this.theta=radian}}else{if(this.leader){this.mirror();this.obj.x=this.x;this.obj.y=this.y;this.obj.angle=90+Phaser.Math.radToDeg(this.theta);if(this.leader.goToAim||!this.leader.alive){if(this.isPrilet)MainGame.state.whatPlaceInGrid(this);this.goToAim=true;this.leader=null}return}if(!this.isTempMob){if(this.isAngry==1){if(this.type==1){if(this.cur_cmd==5){this.goAttackAngry();this.cur_cmd=5}}else if(this.type==2){if(this.cur_cmd==2){this.goAttackAngry();this.cur_cmd=3}}else if(this.type==3){if(this.cur_cmd==4){this.goAttackAngry();this.cur_cmd=5}}}else if(this.isAngry==0){if(this.type>1&&this.isHasBullet){if(this.isPrilet&&MainGame.state.isAttackGrid){if(this.cur_cmd==2){this.prepareStrike(650,.5);this.isHasBullet=false}}else{if(this.cur_cmd==1&&this.isAttacking){this.prepareStrike(650,1);this.isHasBullet=false}}}}}else{if(this.type!=100){if(this.cur_cmd==4){this.goToAim=true;return}}else{if(this.isAngry==1){if(this.cur_cmd==4){this.goAttackAngry();this.cur_cmd=5}}else{if(this.goSamAttack){if(this.cur_cmd==1){this.goToAim=true;return}}}}}this.tick++;var pattern=this.cur_pattern;if(pattern==null){this.remove();return}var i=this.cur_cmd;this.v=8*vSpeed;switch(pattern[i]["cmd"]){case SHIFT_X:this.x=this.aim.x+MyMath.getRandomInt(0,Number(pattern[i]["t"]))*10;this.cur_cmd++;break;case TELEPORT_TO_Y:this.x=this.aim.x;this.y=pattern[i]["t"];this.theta=this.MATH_PI/2;this.cur_cmd++;break;case TRANSLATE_TO_X_LR:if(this.x>=pattern[i]["t"]){this.cur_cmd++}break;case TRANSLATE_TO_X_RL:if(this.x<=pattern[i]["t"]){this.cur_cmd++}break;case TRANSLATE_TO_Y:if(this.y>=pattern[i]["t"]){this.cur_cmd++}break;case TRANSLATE:this.dt+=this.v;if(this.dt>=pattern[i]["frames"]){this.dt=0;this.cur_cmd++}break;case ROTATE:this.dtheta+=pattern[i]["theta"]*vSpeed;this.theta+=pattern[i]["theta"]*vSpeed;if(pattern[i]["max"]<0){if(this.dtheta<=pattern[i]["max"]){this.dtheta=0;this.cur_cmd++}}else{if(this.dtheta>=pattern[i]["max"]){this.dtheta=0;this.cur_cmd++}}break}this.cosine=Math.cos(this.theta);this.sine=Math.sin(this.theta);this.x=this.v*this.cosine+this.x;this.y=this.v*this.sine+this.y;if(this.isCapturing&&this.cur_cmd==2){this.goWave();return}if(this.cur_cmd>=pattern.length){if(this.type==100){if(this.goSamAttack||this.isAngry==2){MainGame.state.isRedShip=false;MainGame.state.redShip=null;this.remove();return}else{this.goToAim=true}}else{if(this.isAngry==2&&!MainGame.state.isKilledCapture){if(MainGame.state.isGameOver){this.goToAim=true}else{this.cur_cmd=0;this.prepareStrike(850,1)}}else{if(this.isPrilet)MainGame.state.whatPlaceInGrid(this);this.goToAim=true}this.isHasBullet=true}}}this.obj.x=this.x;this.obj.y=this.y;this.obj.angle=90+Phaser.Math.radToDeg(this.theta)};Bot.prototype.prepareStrike=function(vTime,vMn){if(this.health<1)return;
if(!this.alive)return;var countBullet=MyMath.getRandomInt(1,MainGame.state.countBullets);for(var i=0;i<countBullet;i++){if(Phaser.Utils.chanceRoll(MainGame.state.chanceStrike*vMn))this.goStrike(vTime+i*130)}};Bot.prototype.remove=function(){this.obj.destroy();MainGame.state.removeAlien(this)};MainGame.Game=function(game){this.layerMain=null};MainGame.Game.prototype={create:function(){MainGame.state=this;MainGame.stateName="ScreenGame";if(MainGame.showFPS)MainGame.showFps(550,20);this.layerBack=game.add.group();this.layerBack.y=-5;this.layerAliens=game.add.group();this.layerBullets=game.add.group();this.layerMain=game.add.group();this.layerTop=game.add.group();this.layerStageNum=this.layerTop.add(game.add.group());this.lifes=4;this.DISTANCE=62;this.MODE_SOS=10;this.scoreGame=0;this.stageNum=0;this.stat_shots=0;this.stat_hits=0;this.player2=null;this.isDoubleShip=false;this.isGameOver=true;this.isPause=false;this.isGameFinished=false;this.layerBack.alpha=.65;this.initStars(this.layerBack);var midY=125;var distY=52;this.arAimXY=[{i:-1,y:midY+distY*3},{i:1,y:midY+distY*3},{i:-1,y:midY+distY*4},{i:1,y:midY+distY*4},{i:-1,y:midY+distY*1},{i:1,y:midY+distY*1},{i:-1,y:midY+distY*2},{i:1,y:midY+distY*2},{i:-3,y:midY+distY*0},{i:-3,y:midY+distY*1},{i:-1,y:midY+distY*0},{i:3,y:midY+distY*1},{i:1,y:midY+distY*0},{i:-3,y:midY+distY*2},{i:3,y:midY+distY*0},{i:3,y:midY+distY*2},{i:5,y:midY+distY*1},{i:-7,y:midY+distY*1},{i:7,y:midY+distY*1},{i:-5,y:midY+distY*1},{i:5,y:midY+distY*2},{i:-7,y:midY+distY*2},{i:7,y:midY+distY*2},{i:-5,y:midY+distY*2},{i:3,y:midY+distY*3},{i:-5,y:midY+distY*3},{i:5,y:midY+distY*3},{i:-3,y:midY+distY*3},{i:3,y:midY+distY*4},{i:-5,y:midY+distY*4},{i:5,y:midY+distY*4},{i:-3,y:midY+distY*4},{i:7,y:midY+distY*3},{i:-9,y:midY+distY*3},{i:9,y:midY+distY*3},{i:-7,y:midY+distY*3},{i:7,y:midY+distY*4},{i:-9,y:midY+distY*4},{i:9,y:midY+distY*4},{i:-7,y:midY+distY*4}];if(game.device.desktop){this.cursors=game.input.keyboard.createCursorKeys();this.fireButtonSpace=game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);this.fireButtonX=game.input.keyboard.addKey(Phaser.Keyboard.X)}this.gameInfo=MainGame.addText(1,320,430,"",this.layerTop,30,"#FE0000",.5,0);this.gamePaused=MainGame.addText(1,320,370,MainGame.GAME_TEXT.pause,this.layerTop,32,"#FE0000",.5,0);this.gamePaused.visible=false;var text=MainGame.addText(1,320,5,MainGame.GAME_TEXT.high_score,this.layerTop,30,"#FE0000",.5,0);MainGame.updateTextWidth(text,340);MainGame.addText(0,320,35,MainGame.highScore,this.layerTop,30,"#DDDDDD",.5,0);this.shipLife1=this.layerTop.add(game.add.sprite(10+50*0,900,"ss_main","ship_0000"));this.shipLife2=this.layerTop.add(game.add.sprite(10+50*1,900,"ss_main","ship_0000"));this.shipLife3=this.layerTop.add(game.add.sprite(10+50*2,900,"ss_main","ship_0000"));MainGame.addText(0,60,5,"1UP",this.layerTop,30,"#FE0000",.5,0);this.txtScore=MainGame.addText(0,120,35,"0",this.layerTop,30,"#DDDDDD",1,0);this.btnPause=this.layerTop.add(game.add.sprite(610,30,"ss_menu","btn_pause_0000"));this.btnPause.anchor.setTo(.5,.5);game.input.onDown.add(this.clickStage,this);this.addPlayer(320,760);this.player.visible=false;this.addAlienBullets();this.addWaveObject();game.time.events.loop(500,this.animationBeat,this);if(!MainGame.isDebug){this.showStart()}else{this.updateLifes()}MainGame.resizeGame();MainGame.fadeOut();if(MainGame.isAPI)GamifiveSDK.startSession()},clickStage:function(){var clickPosX=this.game.input.worldX;var clickPosY=this.game.input.worldY;if(clickPosX>585&&clickPosY<50&&clickPosX<640){this.clickPause()}},clickPause:function(){this.isPause=!this.isPause;if(this.isPause){if(MainGame.isAPI)GamifiveSDK.showMoreGamesButton()}else{if(MainGame.isAPI)GamifiveSDK.hideMoreGamesButton()}this.gamePaused.visible=this.isPause;game.paused=this.isPause},showStart:function(){this.gameInfo.setText(MainGame.GAME_TEXT.start);game.time.events.add(6500,this.updateStage,this,true).autoDestroy=true;MainGame.playSound(2);var text=MainGame.addText(1,320,500,MainGame.GAME_TEXT.how_to_play,this.layerStageNum,26,"#FFFFFF",.5,.5);MainGame.updateTextWidth(text,500);var text=MainGame.addText(1,320,550,MainGame.GAME_TEXT.tap_shoot_move,this.layerStageNum,26,"#FFFFFF",.5,.5);MainGame.updateTextWidth(text,500);if(game.device.desktop){var icon=this.layerStageNum.add(game.add.sprite(80,590,"ss_menu","tut_aim_0000"));icon.anchor.setTo(.5);var text=MainGame.addText(1,320,650,MainGame.GAME_TEXT.or,this.layerStageNum,26,"#FFFFFF",.5,.5);MainGame.updateTextWidth(text,70);icon=this.layerStageNum.add(game.add.sprite(40,750,"ss_menu","tut_key_btn2_0000"));icon.anchor.setTo(.5);var text=MainGame.addText(1,100,750,MainGame.GAME_TEXT.or,this.layerStageNum,26,"#FFFFFF",.5,.5);MainGame.updateTextWidth(text,70);var text=MainGame.addText(1,140,810,MainGame.GAME_TEXT.shoot,this.layerStageNum,26,"#FFFFFF",.5,.5);MainGame.updateTextWidth(text,285);icon=this.layerStageNum.add(game.add.sprite(210,750,"ss_menu","tut_key_btn0_0000"));icon.anchor.setTo(.5);var text=MainGame.addText(1,210,750,MainGame.GAME_TEXT.space,this.layerStageNum,26,"#010101",.5,.5);MainGame.updateTextWidth(text,135);icon=this.layerStageNum.add(game.add.sprite(500-20,750,"ss_menu","tut_key_btn3_0000"));icon.anchor.setTo(.5);icon=this.layerStageNum.add(game.add.sprite(500+20,750,"ss_menu","tut_key_btn3_0000"));icon.anchor.setTo(.5);icon.scale.x=-1;var text=MainGame.addText(1,500,810,MainGame.GAME_TEXT.arrow_to_move,this.layerStageNum,26,"#FFFFFF",.5,.5);MainGame.updateTextWidth(text,285)}else{var icon=this.layerStageNum.add(game.add.sprite(80,590,"ss_menu","tut_arm_0000"));icon.anchor.setTo(.5)}},initSettings:function(){this.COUNT_SHIPS=0;this.ships=[];this.gridPos=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.arParty={};this.isPanic=false;this.isRunMobs=false;this.isTimeBeating=false;this.isWaving=false;this.weAreCaptured=false;this.whoCaptureUs=null;this.isRedShip=false;this.isKilledCapture=false;this.isSparivanie=false;this.animationTick=true;this.tickBand=0;this.killed=0;this.gridStatus=0;this.bulletTime=0;this.numPlayerBullet=0;this.numAlienBullet=0;this.offsetDirection=1;this.offsetCounter=4;this.spreadCounter=0;this.spreadDirection=1;this.deltaGridX=0;this.flagAttack=true;this.stopCheck=false},addLevelWave:function(vNum){if(this.stageNum==1){switch(vNum){case 0:this.addBand(vNum,[3,3,3,3],0,4,90,320+50,-50,PATTERNS.way1_R);this.addBand(vNum,[2,2,2,2],4,8,90,320-50,-50,PATTERNS.way1_L);break;case 1:this.addBand(vNum,[1,2,1,2,1,2,1,2],8,16,0,-50,650,PATTERNS.way2_L);break;case 2:this.addBand(vNum,[2,2,2,2,2,2,2,2],16,24,180,640+50,650,PATTERNS.way2_R);break;case 3:this.addBand(vNum,[3,3,3,3,3,3,3,3],24,32,90,320+50,-50,PATTERNS.way1_R);break;case 4:this.addBand(vNum,[3,3,3,3,3,3,3,3],32,40,90,320-50,-50,PATTERNS.way1_L);break}}else{switch(vNum){case 0:var arMob1=[3,3,3,3];var arMob2=[2,2,2,2];for(var i=1;i<=this.countZapas;i++){if(i%2==0){arMob1.push(3);arMob2.push(2)}}var r=MyMath.getRandomInt(0,3);switch(r){case 0:this.addBand(vNum,arMob1,0,4,90,320+50,-50,PATTERNS.way1_R);this.addBand(vNum,arMob2,4,8,90,320-50,-50,PATTERNS.way1_L);break;case 1:this.addBand(vNum,arMob1,0,4,90,320-50,-50,PATTERNS.way1_L);this.addBand(vNum,arMob2,4,8,90,320+50,-50,PATTERNS.way1_R);break;case 2:this.addBand(vNum,arMob1,0,4,180,640+50,650,PATTERNS.way2_R);this.addBand(vNum,arMob2,4,8,0,-50,650,PATTERNS.way2_L);break;case 3:this.addBand(vNum,arMob1,0,4,0,-50,650,PATTERNS.way2_L);this.addBand(vNum,arMob2,4,8,180,640+50,650,PATTERNS.way2_R);break}break;case 1:var arMob1=[1,1,1,1];var arMob2=[2,2,2,2];for(var i=1;i<=this.countZapas;i++){if(i%2==0){arMob1.push(1);arMob2.push(2)}}var arMob3=[];for(var i=0;i<arMob1.length;i++){arMob3.push(arMob1[i]);arMob3.push(arMob2[i])}var r=MyMath.getRandomInt(0,4);switch(r){case 0:this.addBand(vNum,arMob3,8,16,0,-50,650,PATTERNS.way2_L);break;case 1:this.addBand(vNum,arMob3,8,16,180,640+50,650,PATTERNS.way2_R);break;case 2:this.addBand(vNum,arMob3,8,16,0,-50,650,PATTERNS.way2_L,true,true);break;case 3:this.addBand(vNum,arMob3,8,16,180,640+50,650,PATTERNS.way2_R,true,false);break;case 4:if(this.countZapas==0){arMob1=[1,2,1,2];arMob2=[1,2,1,2]}else if(this.countZapas==2){arMob1=[1,2,1,2,1];arMob2=[1,2,1,2,1]}else if(this.countZapas==4){arMob1=[1,2,1,2,1,2];arMob2=[1,2,1,2,1,2]}this.addBand(vNum,arMob1,8,12,180,640+50,650,PATTERNS.way2_R);this.addBand(vNum,arMob2,12,16,0,-50,650,PATTERNS.way2_L);break}break;case 2:var arMob1=[2,2,2,2];var arMob2=[2,2,2,2];for(var i=1;i<=this.countZapas;i++){if(i%2==0){arMob1.push(2);arMob2.push(2)}}var arMob3=[];for(var i=0;i<arMob1.length;i++){arMob3.push(arMob1[i]);arMob3.push(arMob2[i])}var r=MyMath.getRandomInt(0,9);switch(r){case 0:this.addBand(vNum,arMob3,16,24,180,640+50,650,PATTERNS.way2_R);break;case 1:this.addBand(vNum,arMob3,16,24,0,-50,650,PATTERNS.way2_L);break;case 2:this.addBand(vNum,arMob3,16,24,90,320+50,-50,PATTERNS.way1_R);break;case 3:this.addBand(vNum,arMob3,16,24,90,320-50,-50,PATTERNS.way1_L);break;case 4:this.addBand(vNum,arMob3,16,24,90,320+50,-50,PATTERNS.way1_R,true,true);break;case 5:this.addBand(vNum,arMob3,16,24,90,320-50,-50,PATTERNS.way1_L,true,false);break;case 6:this.addBand(vNum,arMob3,16,24,180,640+50,650,PATTERNS.way2_R,true,false);break;case 7:this.addBand(vNum,arMob3,16,24,0,-50,650,PATTERNS.way2_L,true,true);break;case 8:this.addBand(vNum,arMob1,16,20,90,320+50,-50,PATTERNS.way1_R);this.addBand(vNum,arMob2,20,24,90,320-50,-50,PATTERNS.way1_L);break;case 9:this.addBand(vNum,arMob1,16,20,180,640+50,650,PATTERNS.way2_R);this.addBand(vNum,arMob2,20,24,0,-50,650,PATTERNS.way2_L);break}break;case 3:var arMob1=[3,3,3,3];var arMob2=[3,3,3,3];for(var i=1;i<=this.countZapas;i++){if(i%2==0){arMob1.push(3);arMob2.push(3)}}var arMob3=[];for(var i=0;i<arMob1.length;i++){arMob3.push(arMob1[i]);arMob3.push(arMob2[i])}var r=MyMath.getRandomInt(0,9);switch(r){case 0:this.addBand(vNum,arMob3,24,32,180,640+50,650,PATTERNS.way2_R);break;case 1:this.addBand(vNum,arMob3,24,32,0,-50,650,PATTERNS.way2_L);break;case 2:this.addBand(vNum,arMob3,24,32,90,320+50,-50,PATTERNS.way1_R);break;case 3:this.addBand(vNum,arMob3,24,32,90,320-50,-50,PATTERNS.way1_L);break;case 4:this.addBand(vNum,arMob3,24,32,90,320+50,-50,PATTERNS.way1_R,true,true);break;case 5:this.addBand(vNum,arMob3,24,32,90,320-50,-50,PATTERNS.way1_L,true,false);break;case 6:this.addBand(vNum,arMob3,24,32,180,640+50,650,PATTERNS.way2_R,true,false);break;case 7:this.addBand(vNum,arMob3,24,32,0,-50,650,PATTERNS.way2_L,true,true);break;case 8:this.addBand(vNum,arMob1,24,28,90,320+50,-50,PATTERNS.way1_R);this.addBand(vNum,arMob2,28,32,90,320-50,-50,PATTERNS.way1_L);break;case 9:this.addBand(vNum,arMob1,24,28,180,640+50,650,PATTERNS.way2_R);this.addBand(vNum,arMob2,28,32,0,-50,650,PATTERNS.way2_L);break}break;case 4:var arMob1=[3,3,3,3];var arMob2=[3,3,3,3];for(var i=1;i<=this.countZapas;i++){if(i%2==0){arMob1.push(3);arMob2.push(3)}}var arMob3=[];for(var i=0;i<arMob1.length;i++){arMob3.push(arMob1[i]);arMob3.push(arMob2[i])}var r=MyMath.getRandomInt(0,9);switch(r){case 0:this.addBand(vNum,arMob3,32,40,180,640+50,650,PATTERNS.way2_R);break;case 1:this.addBand(vNum,arMob3,32,40,0,-50,650,PATTERNS.way2_L);break;case 2:this.addBand(vNum,arMob3,32,40,90,320+50,-50,PATTERNS.way1_R);break;case 3:this.addBand(vNum,arMob3,32,40,90,320-50,-50,PATTERNS.way1_L);break;case 4:this.addBand(vNum,arMob3,32,40,90,320+50,-50,PATTERNS.way1_R,true,true);break;case 5:this.addBand(vNum,arMob3,32,40,90,320-50,-50,PATTERNS.way1_L,true,false);break;case 6:this.addBand(vNum,arMob3,32,40,180,640+50,650,PATTERNS.way2_R,true,false);break;case 7:this.addBand(vNum,arMob3,32,40,0,-50,650,PATTERNS.way2_L,true,true);break;case 8:this.addBand(vNum,arMob1,32,36,90,320+50,-50,PATTERNS.way1_R);this.addBand(vNum,arMob2,36,40,90,320-50,-50,PATTERNS.way1_L);break;case 9:this.addBand(vNum,arMob1,32,36,180,640+50,650,PATTERNS.way2_R);this.addBand(vNum,arMob2,36,40,0,-50,650,PATTERNS.way2_L);break}break}}},checkFinishLevel:function(){if(this.isGameFinished)return;if(this.stopCheck)return;if(this.ships.length==0){this.stopCheck=true;game.time.events.add(2e3,this.updateStage,this,false).autoDestroy=true;return}if(!this.isTimeBeating)return;var alien;for(var i=0;i<this.COUNT_SHIPS;i++){alien=this.ships[i];if(alien.health==0)alien.remove()}},updateStage:function(vIsFromGameOver){this.stageNum++;this.layerAliens.removeAll();game.time.events.remove(this.timerAttack);game.time.events.remove(this.timerBeating);game.time.events.remove(this.timerAddMobs);this.initSettings();this.SPEED=1.1+this.stageNum*.05;if(this.SPEED>2.5)this.SPEED=2.5;this.TIME_FLY=600-this.SPEED*100;switch(this.stageNum){case 1:this.countBullets=1;this.isAttackGrid=false;this.isUseTransForm=false;this.countZapas=0;break;case 2:this.countBullets=1;this.isAttackGrid=false;this.isUseTransForm=false;this.countZapas=0;break;case 3:this.countBullets=1;this.isAttackGrid=true;this.isUseTransForm=false;this.countZapas=0;break;case 4:this.countBullets=2;this.isAttackGrid=true;this.isUseTransForm=true;this.countZapas=2;break;case 5:this.countBullets=2;this.isAttackGrid=true;this.isUseTransForm=true;this.countZapas=2;break;default:this.countBullets=3;this.isAttackGrid=true;this.isUseTransForm=true;this.countZapas=2;break}this.addLevelWave(0);this.addLevelWave(1);this.addLevelWave(2);this.addLevelWave(3);this.addLevelWave(4);this.chanceStrike=5+5*this.stageNum;if(this.chanceStrike>50)this.chanceStrike=50;if(this.stageNum>=10){this.countZapas=4}this.gameInfo.fill="#52A6FF";this.gameInfo.setText(MainGame.GAME_TEXT.stage+" "+this.stageNum);MainGame.playSound(21);var num=this.stageNum;var arNum=[];var i=0;var c50=Math.floor(num/50);num-=c50*50;var c30=Math.floor(num/30);num-=c30*30;var c20=Math.floor(num/20);num-=c20*20;var c10=Math.floor(num/10);num-=c10*10;var c5=Math.floor(num/5);num-=c5*5;var c=num;for(i=0;i<c50;i++)arNum.push(50);for(i=0;i<c30;i++)arNum.push(30);for(i=0;i<c20;i++)arNum.push(20);for(i=0;i<c10;i++)arNum.push(10);for(i=0;i<c5;i++)arNum.push(5);for(i=0;i<c;i++)arNum.push(1);this.layerStageNum.removeAll();var countIcons=arNum.length-1;var dx=0;var icon;for(i=countIcons;i>=0;i--){switch(arNum[i]){case 1:icon=this.layerStageNum.add(game.add.sprite(640-dx,945,"ss_main","icon1_0000"));icon.anchor.setTo(1,1);dx+=21;break;case 5:icon=this.layerStageNum.add(game.add.sprite(640-dx,945,"ss_main","icon2_0000"));icon.anchor.setTo(1,1);dx+=21;break;case 10:icon=this.layerStageNum.add(game.add.sprite(640-dx,945,"ss_main","icon3_0000"));icon.anchor.setTo(1,1);dx+=40;break;case 20:icon=this.layerStageNum.add(game.add.sprite(640-dx,945,"ss_main","icon4_0000"));icon.anchor.setTo(1,1);dx+=46;break;case 30:icon=this.layerStageNum.add(game.add.sprite(640-dx,945,"ss_main","icon5_0000"));icon.anchor.setTo(1,1);dx+=46;break;case 50:icon=this.layerStageNum.add(game.add.sprite(640-dx,945,"ss_main","icon6_0000"));icon.anchor.setTo(1,1);dx+=46;break}dx+=5}if(vIsFromGameOver){this.minusLife();game.time.events.add(2500,this.checkLifes,this).autoDestroy=true}else{game.time.events.add(2500,this.updateLifes,this).autoDestroy=true}},minusLife:function(){if(this.isGameFinished)return;this.lifes--;if(this.lifes==0)this.isGameFinished=true},checkLifes:function(){if(MainGame.s_sounds14.isPlaying)MainGame.s_sounds14.stop();this.gameInfo.setText("");if(this.lifes==0){this.gameInfo.fill="#FE0000";this.gameInfo.setText(MainGame.GAME_TEXT.game_over);game.time.events.add(4e3,this.showStats,this).autoDestroy=true}else{if(this.isGameFinished)return;this.gameInfo.fill="#FE0000";this.gameInfo.setText(MainGame.GAME_TEXT.ready);game.time.events.add(2500,this.updateLifes,this).autoDestroy=true}},updateLifes:function(){if(this.isGameFinished)return;this.gameInfo.setText("");if(this.lifes==3)this.shipLife3.destroy();if(this.lifes==2)this.shipLife2.destroy();if(this.lifes==1)this.shipLife1.destroy();this.player.visible=true;this.isGameOver=false;game.time.events.remove(this.timerAddMobs);if(!MainGame.isDebug)this.timerAddMobs=game.time.events.loop(this.TIME_FLY,this.goFlyBand,this);if(this.isRedShip){this.player.frameName="ship_0000";this.player.x=320;this.player.y=760;this.playerX=320}},initTimerAttack:function(){this.SPEED=.9;this.attackMob3side=!true;this.attackMob2side=true;this.attackMob1side=!true;this.attackType=0;this.attackMobs();var timeAtt=1e3+this.TIME_FLY;this.timerAttack=game.time.events.loop(timeAtt,this.attackMobs,this)},attackMobs:function(){switch(this.attackType){case 0:this.attackMob3();this.flagAttack=!this.flagAttack;if(this.flagAttack)this.attackMob2();break;case 1:this.attackMob2();if(this.isUseTransForm)this.transformMob();break;case 2:this.attackMob1();break}this.attackType++;if(this.attackType>2)this.attackType=0},timeAttack:function(vNum,vSide,vIsTransform){if(typeof vIsTransform==="undefined")vIsTransform=false;var _typeMob=vNum;var idMob=-1;var _mob;if(vSide){for(var i=0;i<this.COUNT_SHIPS;i++){_mob=this.ships[i];if(_mob.health==0||_mob.type!=_typeMob||_mob.go)continue;if(idMob==-1){idMob=i;continue}if(_mob.aim.x>=this.ships[idMob].aim.x&&_mob.aim.y>=this.ships[idMob].aim.y){idMob=i}}}else{for(var i=0;i<this.COUNT_SHIPS;i++){_mob=this.ships[i];if(_mob.health==0||_mob.type!=_typeMob||_mob.go)continue;if(idMob==-1){idMob=i;continue}if(_mob.aim.x<=this.ships[idMob].aim.x&&_mob.aim.y>=this.ships[idMob].aim.y){idMob=i}}}if(idMob>=0){this.ships[idMob].goAttack(vIsTransform)}},transformMob:function(){if(this.isGameOver)return;var isBeeHere=false;for(var i=0;i<this.COUNT_SHIPS;i++){if(this.ships[i].type==3){isBeeHere=true;break}}if(isBeeHere){this.timeAttack(3,this.attackMob3side,true)}else{this.timeAttack(2,this.attackMob2side,true)}},attackMob3:function(){if(this.isGameOver||this.isSparivanie)return;this.timeAttack(3,this.attackMob3side);this.attackMob3side=!this.attackMob3side},attackMob2:function(){if(this.isGameOver||this.isSparivanie)return;this.timeAttack(2,this.attackMob2side);this.attackMob2side=!this.attackMob2side},attackMob1:function(){if(this.isGameOver||this.isSparivanie)return;this.timeAttack(1,this.attackMob1side);this.attackMob1side=!this.attackMob1side;if(this.isRedShip&&this.whoCaptureUs==null&&this.redShip!=null){this.redShip.goAttack();this.redShip.goSamAttack=true;this.redShip.aim.x=this.player.x;this.redShip.aim.y=1e3}},moveGrid:function(){if(this.gridStatus==1){this.deltaGridX+=this.offsetDirection*12;for(var i=0;i<this.COUNT_SHIPS;i++){this.ships[i].updateGridPosition(this.offsetDirection*12)}this.offsetCounter++;if(this.offsetCounter==8){this.offsetCounter=0;this.offsetDirection*=-1}}else if(this.gridStatus==2){if(this.offsetCounter!=4){for(var i=0;i<this.COUNT_SHIPS;i++){this.ships[i].updateGridPosition(this.offsetDirection*12)}this.offsetCounter++;if(this.offsetCounter==8){this.offsetCounter=0;this.offsetDirection*=-1}}else{this.timerBeating=game.time.events.loop(500,this.beatGrid,this);this.isTimeBeating=true;this.initTimerAttack()}}},showIDs:function(){for(var i=0;i<this.COUNT_SHIPS;i++){this.ships[i].showId()}},beatGrid:function(){this.spreadCounter+=this.spreadDirection;var dx=this.spreadDirection*(this.spreadCounter%2==0?1:2);if(this.spreadCounter==6||this.spreadCounter==0){this.spreadDirection*=-1}for(var i=0;i<this.COUNT_SHIPS;i++){this.ships[i].updateBeatPosition(dx*.8)}},animationBeat:function(){for(var i=0;i<this.COUNT_SHIPS;i++){this.ships[i].updateAnimation(this.animationTick)}this.animationTick=!this.animationTick;if(!this.isTimeBeating){this.moveGrid()}},whatPlaceInGrid:function(vAlien){var gridN=vAlien.gridPosN;var grid1=vAlien.gridPos1;var grid2=vAlien.gridPos2;var indx=-1;if(gridN>=grid1&&gridN<grid2){indx=gridN;this.gridPos[indx]=1}else{for(var i=grid1;i<grid2;i++){if(this.gridPos[i]==0){this.gridPos[i]=1;indx=i;break}}}if(indx>=0&&indx<40){var arAimXY=this.arAimXY;if(vAlien.type==1&&arAimXY[indx].y>150){vAlien.setAim(this.player.x,1e3);vAlien.isTempMob=true}else if(vAlien.type==2&&arAimXY[indx].y<150){vAlien.setAim(this.player.x,1e3);vAlien.isTempMob=true}else{vAlien.id=indx;vAlien.setAim(320+25*arAimXY[indx].i+this.deltaGridX,arAimXY[indx].y);vAlien.setSide(arAimXY[indx].i)}}else{vAlien.setAim(this.player.x,1e3);vAlien.isTempMob=true;vAlien.goToAim=true}},findShipById:function(vId){var ship=null;for(var i=0;i<this.COUNT_SHIPS;i++){if(this.ships[i].id==vId){ship=this.ships[i];break}}return ship},addBand:function(vNum,vArrTypes,vGrid1,vGrid2,vAngle,vX,vY,vPattern,vIsOffset,vIsInside){var countMobs=vArrTypes.length;var startIndex=this.ships.length;var endIndex=this.ships.length;for(var i=0;i<countMobs;i++){var alien=this.addBot(vArrTypes[i]);this.ships.push(alien);alien.gridPosN=vGrid1+i;alien.gridPos1=vGrid1;alien.gridPos2=vGrid2;alien.bandNum=vNum;endIndex++}this.initFormation(startIndex,endIndex,vAngle,vX,vY,vPattern,vIsOffset,vIsInside);this.COUNT_SHIPS=this.ships.length},removeAlien:function(vObj){this.ships.splice(this.ships.indexOf(vObj),1);this.COUNT_SHIPS=this.ships.length;this.checkFinishLevel()},addAlien:function(vType,vTheta,vX,vY,vSide,vAimX,vAimY,vTick,vStart,vLider){if(typeof vTick==="undefined")vTick=0;if(typeof vStart==="undefined")vStart=0;if(typeof vLider==="undefined")vLider=0;var alien=this.addBot(vType);alien.reset();alien.setPos(vX,vY);alien.setDir(vTheta);alien.leader=null;if(vSide==0){alien.wayAttack1=PATTERNS.attack_M1_A1_R;alien.wayAttack2=PATTERNS.attack_M1_A2_R}else{alien.wayAttack1=PATTERNS.attack_M1_A1_L;alien.wayAttack2=PATTERNS.attack_M1_A2_L}alien.cur_pattern=alien.wayAttack1[0];alien.cur_cmd=0;alien.setAim(vAimX,vAimY);alien.obj.visible=true;alien.isTempMob=true;this.ships.push(alien);this.COUNT_SHIPS=this.ships.length;if(vType==4){alien.go=true;alien.goToAim=true;alien.speed=10}else if(vType==5){alien.go=true;for(var i=0;i<vTick;i++)alien.update(this.SPEED);alien.go=false;game.time.events.add(vStart,function(){alien.go=true},this).autoDestroy=true}else if(vType==6){alien.go=true;for(var i=0;i<vTick;i++)alien.update(this.SPEED);alien.go=false;game.time.events.add(vStart,function(){alien.go=true;alien.tick=vLider.tick;alien.theta=vLider.theta;alien.dtheta=vLider.dtheta;alien.cur_cmd=vLider.cur_cmd},this).autoDestroy=true}else if(vType==100){alien.go=false;alien.setAim(vX,vY)}return alien},goFlyBand:function(){if(this.isGameOver)return;switch(this.tickBand){case 0:this.isRunMobs=true;for(var i=0;i<this.COUNT_SHIPS;i++){alien=this.ships[i];if(alien.bandNum==0)alien.goFly()}break;case 6:this.gridStatus=1;for(var i=0;i<this.COUNT_SHIPS;i++){alien=this.ships[i];if(alien.bandNum==1)alien.goFly()}break;case 14:for(var i=0;i<this.COUNT_SHIPS;i++){alien=this.ships[i];if(alien.bandNum==2)alien.goFly()}break;case 22:for(var i=0;i<this.COUNT_SHIPS;i++){alien=this.ships[i];if(alien.bandNum==3)alien.goFly()}break;case 28:for(var i=0;i<this.COUNT_SHIPS;i++){alien=this.ships[i];if(alien.bandNum==4)alien.goFly()}break;case 34:game.time.events.remove(this.timerAddMobs);this.gridStatus=2;break}this.tickBand++},startGame:function(){this.isRunMobs=true},addPlayer:function(vX,vY){this.playerX=vX;this.arrBullets=[];for(var i=0;i<6;i++){var obj=this.layerBullets.add(game.add.sprite(10,-100,"ss_main","bullet1_0000"));obj.anchor.setTo(.5,.5);this.arrBullets.push(obj)}var obj=this.layerMain.add(game.add.sprite(vX,vY,"ss_main","ship_0000"));obj.anchor.setTo(.5,.5);this.player=obj},showStats:function(){this.gameInfo.setText("");this.player.visible=false;this.layerAliens.removeAll();this.layerBullets.removeAll();var text=MainGame.addText(1,320,250+75*0,"- "+MainGame.GAME_TEXT.result+" -",this.layerTop,30,"#FE0000",.5,0);MainGame.updateTextWidth(text,410);var text=MainGame.addText(1,320-250,250+75*1,MainGame.GAME_TEXT.shots_fired,this.layerTop,30,"#52A6FF",0,0);MainGame.updateTextWidth(text,410);var text=MainGame.addText(1,320-250,250+75*2,MainGame.GAME_TEXT.number_of_hits,this.layerTop,30,"#FFFFFF",0,0);MainGame.updateTextWidth(text,410);var text=MainGame.addText(1,320-250,250+75*3,MainGame.GAME_TEXT.hit_miss_ratio,this.layerTop,30,"#D9C028",0,0);MainGame.updateTextWidth(text,410);MainGame.addText(0,320+250,250+75*1,this.stat_shots,this.layerTop,30,"#52A6FF",1,0);MainGame.addText(0,320+250,250+75*2,this.stat_hits,this.layerTop,30,"#FFFFFF",1,0);var _ratio=0;if(this.stat_shots>0){_ratio=(this.stat_hits/this.stat_shots*100).toFixed(1)}MainGame.addText(0,320+250,250+75*3,_ratio,this.layerTop,30,"#D9C028",1,0);MainGame.addText(0,320+253,250+75*3,"%",this.layerTop,30,"#D9C028",0,0);if(this.scoreGame>MainGame.highScore){MainGame.playSound(23);MainGame.highScore=this.scoreGame}else{MainGame.playSound(24)}MainGame.addButton(this,this.layerTop,320,650,this.clickReplay,MainGame.GAME_TEXT.replay,270,50,26);MainGame.addButton(this,this.layerTop,320,720,this.clickMenu,MainGame.GAME_TEXT.menu,270,50,26);if(MainGame.isAPI)GamifiveSDK.endSession({level:this.stageNum,score:this.scoreGame});MainGame.saveSaves()},addAlienBullets:function(){this.arrAlienBullets=[];for(var i=0;i<10;i++){var obj=this.layerBullets.add(game.add.sprite(-100,-100,"ss_main","bullet2_0000"));obj.anchor.setTo(.5,.5);obj.visible=false;obj.dX=0;this.arrAlienBullets.push(obj)}},attackAlien:function(vStrelok){if(vStrelok.link.health<1)return;MainGame.state.attackAlienGame(vStrelok.x,vStrelok.y)},addWaveObject:function(){var wave=this.layerMain.add(game.add.sprite(0,0,"ss_main"));wave.anchor.setTo(.5,0);wave.animations.add("wave_on",Phaser.Animation.generateFrameNames("wave_on_",0,44,"",4),30);wave.animations.add("wave_loop",Phaser.Animation.generateFrameNames("wave_loop_",0,14,"",4),30);wave.animations.add("wave_off",Phaser.Animation.generateFrameNames("wave_off_",0,44,"",4),30);wave.events.onAnimationComplete.add(this.onWaveAnim,this);wave.play("wave_loop",30,false);wave.visible=false;this.wave=wave},onWaveAnim:function(sprite,animation){if(animation.name==="wave_on"){sprite.play("wave_loop",30,true)}else if(animation.name==="wave_off"){sprite.visible=false}},playerInLogovo:function(vWhoBoss){vWhoBoss.moveBackToBase();this.weAreCaptured=true;MainGame.playSound(14)},playerCaptured:function(){this.isRedShip=true;this.player.frameName="ship_red_0000";this.wave.play("wave_off",60,false);this.isGameOver=true;this.gameInfo.fill="#FE0000";this.gameInfo.setText(MainGame.GAME_TEXT.fighter_captured);if(MainGame.s_sounds11.isPlaying)MainGame.s_sounds11.stop()},updateWaveStatus:function(vNum,vX,vY){if(typeof vX==="undefined")vX=0;if(typeof vY==="undefined")vY=0;switch(vNum){case 1:this.isWaving=true;this.wave.visible=true;this.wave.x=vX;this.wave.y=vY+25;this.wave.play("wave_on",30,false);MainGame.s_sounds10.play("",0,1,true);break;case 2:this.wave.play("wave_off",30,false);break;case 3:this.isWaving=false;if(MainGame.s_sounds10.isPlaying)MainGame.s_sounds10.stop();break;case 4:game.add.tween(this.player).to({x:vX,y:vY-50},700,"Linear",true);this.weAreCaptured=false;game.time.events.add(700,this.addRedShip,this,vX,vY-50).autoDestroy=true;game.time.events.add(2e3,this.checkLifes,this).autoDestroy=true;this.minusLife();this.isWaving=false;break}},addRedShip:function(vX,vY){var redShip=MainGame.state.addAlien(100,-1.57,vX,vY,this.patternSide,320,1e3);this.whoCaptureUs.link.hasRedShip=redShip;this.redShip=redShip;this.player.visible=false;if(this.isPanic){redShip.goAngry()}},addFriend:function(){var obj=this.layerMain.add(game.add.sprite(this.player.x,this.player.y,"ss_main","ship_0000"));obj.anchor.setTo(.5,.5);this.player2=obj;this.isDoubleShip=true},killedCapture:function(vIsGoing){if(!this.isRedShip)return;if(vIsGoing){this.isKilledCapture=true;var obj=this.layerMain.add(game.add.sprite(this.redShip.obj.x,this.redShip.obj.y,"ss_main","ship_0000"));obj.anchor.setTo(.5,.5);this.player2=obj;this.redShip.obj.visible=false;this.redShip=null;game.add.tween(this.player2).to({angle:360},500,"Linear",true).loop(true);game.time.events.add(2500,this.naparnikGoHome,this).autoDestroy=true;MainGame.playSound(14)}},naparnikGoHome:function(){this.isSparivanie=true;game.tweens.removeFrom(this.player2);this.player2.angle=0;game.add.tween(this.player2).to({x:320+25},800,"Linear",true);game.add.tween(this.player2).to({y:760},800,"Linear",true,800);game.add.tween(this.player).to({x:320-25,y:760},800,"Linear",true);game.time.events.add(1600,this.continueGameWithFriend,this).autoDestroy=true;this.playerX=320;if(MainGame.s_sounds14.isPlaying)MainGame.s_sounds14.stop()},continueGameWithFriend:function(){this.isSparivanie=false;this.isDoubleShip=true},checkWaves:function(vObj){if(this.isGameOver)return;var _playerX=this.player.x;var _wX1=this.wave.x-80;var _wX2=this.wave.x+80;if(_playerX>_wX1&&_playerX<_wX2){this.whoCaptureUs=vObj;this.isGameOver=true;vObj.link.stopWaving();game.add.tween(this.player).to({x:this.wave.x,y:this.wave.y+25,angle:360*3},1200,"Linear",true);game.time.events.add(1300,this.playerCaptured,this).autoDestroy=true;game.time.events.add(2600,this.playerInLogovo,this,vObj.link).autoDestroy=true;if(MainGame.s_sounds10.isPlaying)MainGame.s_sounds10.stop();MainGame.playSound(11)}},attackAlienGame:function(vX,vY){if(this.isGameOver)return;var _bullet=this.arrAlienBullets[this.numAlienBullet];_bullet.x=vX;_bullet.y=vY;this.numAlienBullet++;if(this.numAlienBullet>9)this.numAlienBullet=0;_bullet.visible=true;var r=Math.atan2(this.player.y-_bullet.y,this.player.x-_bullet.x);_bullet.dX=Math.cos(r)*8},initStars:function(vLayer){var rainParticle=this.game.add.bitmapData(10,10);rainParticle.ctx.rect(0,0,10,10);rainParticle.ctx.fillStyle="#ffffff";rainParticle.ctx.fill();this.emitter=vLayer.add(this.game.add.emitter(this.game.world.centerX,-50,50));this.emitter.width=MainGame.Config.GAME_WIDTH+50;this.emitter.angle=0;this.emitter.gravity=0;this.emitter.makeParticles(rainParticle);this.emitter.minParticleScale=.35;this.emitter.maxParticleScale=.45;this.emitter.minRotation=0;this.emitter.maxRotation=0;this.emitter.setYSpeed(140,240);this.emitter.setXSpeed(0,0);var arColors=[16744576,8434927,16777088,8440779,14606046];this.emitter.forEach(function(particle){particle.tint=arColors[MyMath.getRandomInt(0,4)];particle.timer=MyMath.getRandomInt(0,4);particle.x=MyMath.getRandomInt(0,MainGame.Config.GAME_WIDTH);particle.y=MyMath.getRandomInt(0,MainGame.Config.GAME_HEIGHT);particle.body.velocity.y=MyMath.getRandomInt(140,240);particle.scale.setTo(game.rnd.realInRange(.35,.45));particle.exists=true});this.emitter.start(false,7100,50,0);game.time.events.loop(150,this.updateStars,this)},updateStars:function(){this.emitter.forEach(function(particle){particle.timer++;if(particle.timer>4)particle.timer=0;if(particle.timer==0)particle.visible=true;if(particle.timer==4)particle.visible=false;if(particle.y>960)particle.kill()})},initFormation:function(vIndex0,vIndex1,vAngle,vX,vY,vPattern,vIsOffset,vIsInside){if(typeof vIsOffset==="undefined")vIsOffset=false;if(typeof vIsInside==="undefined")vIsInside=true;var startTheta;var startTheta=Phaser.Math.degToRad(vAngle);var startX=vX;var startY=vY;var j=0;if(vIsOffset){for(var i=vIndex0;i<vIndex1;i++){startX=vX-j*this.DISTANCE*Math.cos(vAngle*Math.PI/180);startY=vY-j*this.DISTANCE*Math.sin(vAngle*Math.PI/180);this.ships[i].reset();this.ships[i].setPos(startX,startY);this.ships[i].setDir(startTheta);if(i%2==0){if(vIsInside){this.ships[i].setFormationOffset(-50)}else{this.ships[i].setFormationOffset(50)}this.ships[i].leader=this.ships[i+1]}else{this.ships[i].setPatternQueue(vPattern);this.ships[i].leader=null;j++}}}else{for(var i=vIndex0;i<vIndex1;i++){startX=vX-j*this.DISTANCE*Math.cos(vAngle*Math.PI/180);startY=vY-j*this.DISTANCE*Math.sin(vAngle*Math.PI/180);this.ships[i].reset();this.ships[i].setPos(startX,startY);this.ships[i].setDir(startTheta);this.ships[i].setPatternQueue(vPattern);this.ships[i].leader=null;j++}}},update:function(){if(!this.isGameOver){if(!this.isSparivanie){if(game.device.desktop){if(this.cursors.left.isDown){this.playerX-=7}else if(this.cursors.right.isDown){this.playerX+=7}if(this.fireButtonSpace.isDown||this.fireButtonX.isDown)this.strikeBullet()}if(game.input.activePointer.isDown){this.strikeBullet();this.playerX-=(this.playerX-game.input.worldX)/10}if(this.playerX<0)this.playerX=0;if(this.playerX>640)this.playerX=640;if(this.isDoubleShip){
this.player.x=this.playerX-25;this.player2.x=this.playerX+25}else{this.player.x=this.playerX}if(!MainGame.isGodMode){for(var j=0;j<this.COUNT_SHIPS;j++){alien=this.ships[j];if(alien.health<1||alien.y<680)continue;if(MyMath.distanceTwoPoints(this.player.x,alien.x,this.player.y,alien.y)<1e3){this.playerHitAlien(alien,1)}else{if(this.isDoubleShip){if(MyMath.distanceTwoPoints(this.player2.x,alien.x,this.player2.y,alien.y)<1e3){this.playerHitAlien(alien,2)}}}}}}}else{if(this.weAreCaptured){this.player.x=this.whoCaptureUs.x;this.player.y=this.whoCaptureUs.y+40}}var bullet;var alien;for(var i=0;i<6;i++){bullet=this.arrBullets[i];bullet.y-=20;if(bullet.y<0)continue;for(var j=0;j<this.COUNT_SHIPS;j++){alien=this.ships[j];if(alien.health<1||!alien.isAdded)continue;if(!this.isGameOver&&MyMath.distanceTwoPoints(bullet.x,alien.x,bullet.y,alien.y)<500){this.bulletHitAlien(bullet,alien.obj)}}}var bullet;for(var i=0;i<10;i++){bullet=this.arrAlienBullets[i];bullet.x+=bullet.dX;bullet.y+=11;if(bullet.y>900||bullet.y<600)continue;if(!MainGame.isGodMode){if(!this.isGameOver){if(MyMath.distanceTwoPoints(bullet.x,this.player.x,bullet.y,this.player.y)<500){this.playerHitBullet(bullet,1)}else{if(this.isDoubleShip&&!bullet.isHitted){if(MyMath.distanceTwoPoints(bullet.x,this.player2.x,bullet.y,this.player2.y)<500){this.playerHitBullet(bullet,2)}}}}}}if(!this.isRunMobs)return;this.updateShips()},playerHitAlien:function(alien,vPlayerNum){if(this.isGameOver||this.isSparivanie)return;if(vPlayerNum==1){this.addEffect(0,this.layerAliens,this.player.x,this.player.y)}else{this.addEffect(0,this.layerAliens,this.player2.x,this.player2.y)}if(this.isDoubleShip){this.isDoubleShip=false;this.player2.visible=false;this.player2=null}else{this.player.visible=false;this.isGameOver=true;game.time.events.add(3500,this.checkLifes,this).autoDestroy=true;this.minusLife()}alien.health=0;alien.visible=false;this.addEffect(1,this.layerAliens,alien.x,alien.y);this.checkFinishLevel();MainGame.playSound(22)},playerHitBullet:function(bullet,vPlayerNum){if(this.isGameOver||this.isSparivanie||bullet.isHitted)return;if(vPlayerNum==1){this.addEffect(0,this.layerAliens,this.player.x,this.player.y)}else{this.addEffect(0,this.layerAliens,this.player2.x,this.player2.y)}if(this.isDoubleShip){this.isDoubleShip=false;this.player2.visible=false;this.player2=null}else{this.player.visible=false;this.isGameOver=true;game.time.events.add(3500,this.checkLifes,this).autoDestroy=true;this.minusLife()}bullet.visible=false;bullet.x=-100;MainGame.playSound(22)},showScoreEffect:function(vX,vY,vCount){var color="#FF0000";switch(vCount){case 400:color="#FF0000";break;case 800:color="#FECB00";break;case 1600:color="#00FFDE";break;case 1e3:color="#0068DE";break;case 2e3:color="#FECB00";break;case 3e3:color="#FEFFFB";break}var showBabki=MainGame.addText(0,vX,vY,vCount,this.layerMain,24,color,.5,.5);showBabki.visible=false;game.time.events.add(400,function(){showBabki.visible=true},this).autoDestroy=true;game.time.events.add(2200,function(){showBabki.destroy()},this).autoDestroy=true},bulletHitAlien:function(bullet,alien){if(this.isGameOver||this.isSparivanie)return;if(bullet.y<0||bullet.isHitted)return;bullet.isHitted=true;bullet.visible=false;this.stat_hits++;alien.link.getDamage();if(alien.link.health<=0){alien.visible=false;this.addEffect(1,this.layerAliens,alien.x,alien.y);var _score=0;if(alien.link.go){_score+=alien.link.score2}else{_score+=alien.link.score1}this.scoreGame+=_score;if(alien.link.partyNum>0){if(this.arParty[String(alien.link.partyNum)]==undefined){this.arParty[String(alien.link.partyNum)]=1}else{this.arParty[String(alien.link.partyNum)]+=1;if(this.arParty[String(alien.link.partyNum)]==3){if(alien.link.isTransformation==1)_score=1e3;if(alien.link.isTransformation==2)_score=2e3;if(alien.link.isTransformation==3)_score=3e3;this.scoreGame+=_score}}}if(_score>200)this.showScoreEffect(alien.x,alien.y,_score);this.txtScore.setText(this.scoreGame);if(!alien.link.isPrilet)alien.link.remove();this.killed++;if(!this.isPanic){if(this.ships.length<=this.MODE_SOS)this.startPanic()}this.checkFinishLevel()}},strikeBullet:function(){if(game.time.now>this.bulletTime){this.fireBullet()}},fireBullet:function(){if(this.isGameOver||this.isSparivanie)return;this.addBullet(this.player.x,this.player.y);if(this.isDoubleShip)this.addBullet(this.player2.x,this.player2.y);this.bulletTime=game.time.now+350;MainGame.playSound(13)},addBullet:function(vX,vY){var _bullet=this.arrBullets[this.numPlayerBullet];_bullet.x=vX;_bullet.y=vY;_bullet.isHitted=false;_bullet.visible=true;this.numPlayerBullet++;if(this.numPlayerBullet>5)this.numPlayerBullet=0;this.stat_shots++},updateShips:function(){var ship;for(var i=0;i<this.COUNT_SHIPS;i++){ship=this.ships[i];ship.update(this.SPEED)}},startPanic:function(){if(!this.isTimeBeating)return;for(var i=0;i<this.COUNT_SHIPS;i++){this.ships[i].goAngry()}this.isPanic=true},clickCapture:function(){this.ships[8].goCapture()},clickPlay:function(){var whoAttack=28;var attacker=this.ships[whoAttack];attacker.goAttack()},clickReset:function(){this.isRunMobs=!this.isRunMobs},addBot:function(vType){var bot=new Bot(game,this.layerAliens,vType,this.attackAlien);return bot},addEffect:function(vNum,vLayer,vX,vY,vAnchorX,vAnchorY){if(typeof vAnchorX==="undefined")vAnchorX=.5;if(typeof vAnchorY==="undefined")vAnchorY=.5;var cframes=[13,15];var obj;var nameEffect;switch(vNum){case 0:nameEffect="boom1";break;case 1:nameEffect="boom2";break}obj=vLayer.add(game.add.sprite(vX,vY,"ss_main"));obj.anchor.setTo(vAnchorX,vAnchorY);obj.animations.add(nameEffect,Phaser.Animation.generateFrameNames(nameEffect+"_",0,cframes[vNum],"",4),30);obj.animations.play(nameEffect,30,false,true);return obj},onEffectAnimationComplete:function(sprite,animation){},clickReplay:function(){if(MainGame.s_sounds23.isPlaying)MainGame.s_sounds23.stop();if(MainGame.s_sounds24.isPlaying)MainGame.s_sounds24.stop();MainGame.goToState("Game")},clickMenu:function(){if(MainGame.s_sounds23.isPlaying)MainGame.s_sounds23.stop();if(MainGame.s_sounds24.isPlaying)MainGame.s_sounds24.stop();MainGame.goToState("Menu")}};MainGame.Menu=function(game){};MainGame.Menu.prototype={create:function(){MainGame.state=this;MainGame.stateName="Menu";MainGame.GAME_TEXT=MainGame.TEXT_FILE[MainGame.languages[MainGame.language]];this.layerBack=game.add.group();this.layerBack.y=-5;this.layerMain=game.add.group();var text=MainGame.addText(1,320,5,MainGame.GAME_TEXT.high_score,this.layerMain,30,"#FE0000",.5,0);MainGame.updateTextWidth(text,340);MainGame.addText(0,320,35,MainGame.highScore,this.layerMain,30,"#DDDDDD",.5,0);var logo=this.layerMain.add(game.add.sprite(320,260,"ss_menu","logo_0000"));logo.anchor.setTo(.5);var logoBandai=this.layerMain.add(game.add.image(560,70,"bandai_logo"));logoBandai.anchor.setTo(.5);this.btnLanguage=new SimpleButton(game,this,this.layerMain,50,40,"ss_menu","language_00"+MainGame.languages[MainGame.language],this.openLanguage);this.panelLanguage=this.layerMain.add(game.add.group());this.btnCloseLanguage=new SimpleButton(game,this,this.panelLanguage,50,40,"ss_menu","btn_close_0000",this.closeLanguage);var arrL=["EN","IT","ES","PT","TR","DE","BR","RU","FR","JP","AR"];arrL.splice(MainGame.language,1);this.btnLang_1=new SimpleButton(game,this,this.panelLanguage,50,90+55*0,"ss_menu","language_00"+arrL[0],this["changeLang"+arrL[0]]);this.btnLang_2=new SimpleButton(game,this,this.panelLanguage,50,90+55*1,"ss_menu","language_00"+arrL[1],this["changeLang"+arrL[1]]);this.btnLang_3=new SimpleButton(game,this,this.panelLanguage,50,90+55*2,"ss_menu","language_00"+arrL[2],this["changeLang"+arrL[2]]);this.btnLang_4=new SimpleButton(game,this,this.panelLanguage,50,90+55*3,"ss_menu","language_00"+arrL[3],this["changeLang"+arrL[3]]);this.btnLang_5=new SimpleButton(game,this,this.panelLanguage,50,90+55*4,"ss_menu","language_00"+arrL[4],this["changeLang"+arrL[4]]);this.btnLang_6=new SimpleButton(game,this,this.panelLanguage,50,90+55*5,"ss_menu","language_00"+arrL[5],this["changeLang"+arrL[5]]);this.btnLang_7=new SimpleButton(game,this,this.panelLanguage,50,90+55*6,"ss_menu","language_00"+arrL[6],this["changeLang"+arrL[6]]);this.btnLang_8=new SimpleButton(game,this,this.panelLanguage,50,90+55*7,"ss_menu","language_00"+arrL[7],this["changeLang"+arrL[7]]);this.btnLang_9=new SimpleButton(game,this,this.panelLanguage,50,90+55*8,"ss_menu","language_00"+arrL[8],this["changeLang"+arrL[8]]);this.btnLang_10=new SimpleButton(game,this,this.panelLanguage,50,90+55*9,"ss_menu","language_00"+arrL[9],this["changeLang"+arrL[9]]);this.panelLanguage.visible=false;var btnTap=MainGame.addButton(this,this.layerMain,320,450,this.clickStart,MainGame.GAME_TEXT.tap_to_start,270,50,26);MainGame.updateTextWidth(btnTap.text,340);this.layerCredits=game.add.group();this.isCreditsShown=false;this.layerCredits.visible=false;var text=MainGame.addText(1,320,600,MainGame.GAME_TEXT.credits,this.layerCredits,30,"#FFFFFF",.5,.5);MainGame.updateTextWidth(text,300);var text=MainGame.addText(1,320,660,MainGame.GAME_TEXT.developed_by,this.layerCredits,22,"#FFFFFF",.5,.5);MainGame.updateTextWidth(text,300);MainGame.addText(1,320,700,"nsbrotherhood",this.layerCredits,26,"#FE0000",.5,.5);this.creditsClose=this.layerCredits.add(game.add.sprite(500,560,"ss_menu","btn_close_0000"));this.creditsClose.anchor.setTo(.5,.5);this.creditsClose.inputEnabled=true;this.creditsClose.events.onInputDown.add(this.showCredits,this);this.creditsBtn=game.add.image(600,870,"ss_menu","btn_credits_0000");this.creditsBtn.anchor.setTo(.5,.5);this.creditsBtn.inputEnabled=true;this.creditsBtn.events.onInputDown.add(this.showCredits,this);game.physics.startSystem(Phaser.Physics.ARCADE);this.layerBack.alpha=.65;this.initStars(this.layerBack);MainGame.addText(0,320,920,"GALAGA MINI         2017 BANDAI NAMCO Entertainment Inc.",this.layerMain,24,"#FE0000",.5,.5,MainGame.styleText2);var cpr=this.layerMain.add(game.add.sprite(187,916,"ss_menu","copyright_0000"));cpr.anchor.setTo(.5);MainGame.resizeGame();MainGame.fadeOut();if(MainGame.isAPI)GamifiveSDK.showMoreGamesButton()},openLanguage:function(){this.btnLanguage.buttonC.visible=false;this.panelLanguage.visible=true;this.panelLanguage.x=-400;game.add.tween(this.panelLanguage).to({x:0},400,"Back.easeOut").start()},closeLanguage:function(){game.add.tween(this.panelLanguage).to({x:-400},400,"Back.easeIn",true).onComplete.add(function(){MainGame.state.panelLanguage.visible=false});this.btnLanguage.buttonC.visible=true},changeLangEN:function(){this.updateLanguage(0)},changeLangIT:function(){this.updateLanguage(1)},changeLangES:function(){this.updateLanguage(2)},changeLangPT:function(){this.updateLanguage(3)},changeLangTR:function(){this.updateLanguage(4)},changeLangDE:function(){this.updateLanguage(5)},changeLangBR:function(){this.updateLanguage(6)},changeLangRU:function(){this.updateLanguage(7)},changeLangFR:function(){this.updateLanguage(8)},changeLangJP:function(){this.updateLanguage(9)},changeLangAR:function(){this.updateLanguage(10)},updateLanguage:function(vPar){MainGame.language=vPar;MainGame.goToState("Menu")},showCredits:function(){this.isCreditsShown=!this.isCreditsShown;if(this.isCreditsShown){this.layerCredits.visible=true;this.layerCredits.y=500;game.add.tween(this.layerCredits).to({y:100},400,"Back.easeOut",true)}else{game.add.tween(this.layerCredits).to({y:500},400,"Back.easeIn",true).onComplete.add(function(){MainGame.state.layerCredits.visible=false})}},initStars:function(vLayer){var rainParticle=this.game.add.bitmapData(10,10);rainParticle.ctx.rect(0,0,10,10);rainParticle.ctx.fillStyle="#ffffff";rainParticle.ctx.fill();this.emitter=vLayer.add(this.game.add.emitter(this.game.world.centerX,-50,50));this.emitter.width=MainGame.Config.GAME_WIDTH+50;this.emitter.angle=0;this.emitter.gravity=0;this.emitter.makeParticles(rainParticle);this.emitter.minParticleScale=.35;this.emitter.maxParticleScale=.45;this.emitter.minRotation=0;this.emitter.maxRotation=0;this.emitter.setYSpeed(140,240);this.emitter.setXSpeed(0,0);var arColors=[16744576,8434927,16777088,8440779,14606046];this.emitter.forEach(function(particle){particle.tint=arColors[MyMath.getRandomInt(0,4)];particle.timer=MyMath.getRandomInt(0,4);particle.x=MyMath.getRandomInt(0,MainGame.Config.GAME_WIDTH);particle.y=MyMath.getRandomInt(0,MainGame.Config.GAME_HEIGHT);particle.body.velocity.y=MyMath.getRandomInt(140,240);particle.scale.setTo(game.rnd.realInRange(.35,.45));particle.exists=true});this.emitter.start(false,7100,50,0);game.time.events.loop(150,this.updateStars,this)},updateStars:function(){this.emitter.forEach(function(particle){particle.timer++;if(particle.timer>4)particle.timer=0;if(particle.timer==0)particle.visible=true;if(particle.timer==4)particle.visible=false;if(particle.y>960)particle.kill()})},clickStart:function(){if(MainGame.isAPI)GamifiveSDK.hideMoreGamesButton();MainGame.goToState("Game")}};var ROTATE=0;var TRANSLATE=1;var TRANSLATE_TO_Y=2;var TRANSLATE_TO_X_RL=3;var TRANSLATE_TO_X_LR=4;var TELEPORT_TO_Y=5;var SHIFT_X=6;var PATTERNS={};const MATH_PI=3.1415;var pattern_BackL=[{cmd:ROTATE,theta:MATH_PI/15,max:MATH_PI/1}];var pattern_BackR=[{cmd:ROTATE,theta:-MATH_PI/15,max:-MATH_PI/1}];var pattern_1_R=[{cmd:TRANSLATE_TO_Y,t:90},{cmd:ROTATE,theta:MATH_PI/30,max:MATH_PI/3.1},{cmd:TRANSLATE,frames:270},{cmd:ROTATE,theta:-MATH_PI/45,max:-MATH_PI/.8},{cmd:TRANSLATE,frames:10}];var pattern_1_L=[{cmd:TRANSLATE_TO_Y,t:90},{cmd:ROTATE,theta:-MATH_PI/30,max:-MATH_PI/3.1},{cmd:TRANSLATE,frames:270},{cmd:ROTATE,theta:MATH_PI/45,max:MATH_PI/.8},{cmd:TRANSLATE,frames:10}];var pattern_2_R=[{cmd:TRANSLATE_TO_X_RL,t:590},{cmd:ROTATE,theta:MATH_PI/80,max:MATH_PI/1.7},{cmd:ROTATE,theta:MATH_PI/45,max:MATH_PI/.6},{cmd:TRANSLATE,frames:60}];var pattern_2_L=[{cmd:TRANSLATE_TO_X_LR,t:50},{cmd:ROTATE,theta:-MATH_PI/80,max:-MATH_PI/1.7},{cmd:ROTATE,theta:-MATH_PI/45,max:-MATH_PI/.6},{cmd:TRANSLATE,frames:60}];var pattern_M1_A1_R=[{cmd:ROTATE,theta:MATH_PI/14,max:MATH_PI/.92},{cmd:ROTATE,theta:MATH_PI/65,max:MATH_PI/3.6},{cmd:ROTATE,theta:-MATH_PI/140,max:-MATH_PI/4},{cmd:TRANSLATE_TO_Y,t:700},{cmd:ROTATE,theta:-MATH_PI/45,max:-MATH_PI/3},{cmd:ROTATE,theta:-MATH_PI/45,max:-MATH_PI/1.2}];var pattern_M1_A1_L=[{cmd:ROTATE,theta:-MATH_PI/14,max:-MATH_PI/.92},{cmd:ROTATE,theta:-MATH_PI/65,max:-MATH_PI/3.6},{cmd:ROTATE,theta:MATH_PI/140,max:MATH_PI/4},{cmd:TRANSLATE_TO_Y,t:700},{cmd:ROTATE,theta:MATH_PI/45,max:MATH_PI/3},{cmd:ROTATE,theta:MATH_PI/45,max:MATH_PI/1.2}];var pattern_M1_A2_R=[{cmd:ROTATE,theta:-MATH_PI/40,max:-MATH_PI/4},{cmd:TRANSLATE,frames:100},{cmd:ROTATE,theta:MATH_PI/45,max:MATH_PI/1.75},{cmd:TRANSLATE,frames:280},{cmd:ROTATE,theta:-MATH_PI/110,max:-MATH_PI/2.5},{cmd:TRANSLATE_TO_Y,t:750},{cmd:ROTATE,theta:-MATH_PI/40,max:-MATH_PI/.49},{cmd:TRANSLATE_TO_Y,t:1e3},{cmd:TELEPORT_TO_Y,t:-50},{cmd:SHIFT_X,t:-10}];var pattern_M1_A2_L=[{cmd:ROTATE,theta:MATH_PI/40,max:MATH_PI/4},{cmd:TRANSLATE,frames:100},{cmd:ROTATE,theta:-MATH_PI/45,max:-MATH_PI/1.75},{cmd:TRANSLATE,frames:280},{cmd:ROTATE,theta:MATH_PI/110,max:MATH_PI/2.5},{cmd:TRANSLATE_TO_Y,t:750},{cmd:ROTATE,theta:MATH_PI/40,max:MATH_PI/.49},{cmd:TRANSLATE_TO_Y,t:1e3},{cmd:TELEPORT_TO_Y,t:-50},{cmd:SHIFT_X,t:10}];var pattern_M2_A1_R=[{cmd:ROTATE,theta:MATH_PI/13,max:MATH_PI/.77},{cmd:TRANSLATE,frames:230},{cmd:ROTATE,theta:-MATH_PI/42,max:-MATH_PI/2.7},{cmd:ROTATE,theta:MATH_PI/42,max:MATH_PI/2.7},{cmd:ROTATE,theta:-MATH_PI/42,max:-MATH_PI/2.6},{cmd:TRANSLATE_TO_Y,t:1e3},{cmd:TELEPORT_TO_Y,t:-50}];var pattern_M2_A1_L=[{cmd:ROTATE,theta:-MATH_PI/13,max:-MATH_PI/.77},{cmd:TRANSLATE,frames:230},{cmd:ROTATE,theta:MATH_PI/42,max:MATH_PI/2.7},{cmd:ROTATE,theta:-MATH_PI/42,max:-MATH_PI/2.7},{cmd:ROTATE,theta:MATH_PI/42,max:MATH_PI/2.6},{cmd:TRANSLATE_TO_Y,t:1e3},{cmd:TELEPORT_TO_Y,t:-50}];var pattern_M2_A2_R=[{cmd:ROTATE,theta:-MATH_PI/100,max:-MATH_PI/4},{cmd:ROTATE,theta:MATH_PI/50,max:MATH_PI/1.9},{cmd:TRANSLATE,frames:125},{cmd:ROTATE,theta:-MATH_PI/42,max:-MATH_PI/2.7},{cmd:ROTATE,theta:MATH_PI/42,max:MATH_PI/2.7},{cmd:ROTATE,theta:-MATH_PI/42,max:-MATH_PI/2.6},{cmd:TRANSLATE_TO_Y,t:1e3},{cmd:TELEPORT_TO_Y,t:-50},{cmd:SHIFT_X,t:-10}];var pattern_M2_A2_L=[{cmd:ROTATE,theta:MATH_PI/100,max:MATH_PI/4},{cmd:ROTATE,theta:-MATH_PI/50,max:-MATH_PI/1.9},{cmd:TRANSLATE,frames:125},{cmd:ROTATE,theta:MATH_PI/42,max:MATH_PI/2.7},{cmd:ROTATE,theta:-MATH_PI/42,max:-MATH_PI/2.7},{cmd:ROTATE,theta:MATH_PI/42,max:MATH_PI/2.6},{cmd:TRANSLATE_TO_Y,t:1e3},{cmd:TELEPORT_TO_Y,t:-50},{cmd:SHIFT_X,t:10}];var pattern_M3_A1_R=[{cmd:ROTATE,theta:-MATH_PI/20,max:-MATH_PI/.98},{cmd:TRANSLATE,frames:170},{cmd:ROTATE,theta:-MATH_PI/32,max:-MATH_PI/.5},{cmd:TRANSLATE,frames:70},{cmd:ROTATE,theta:-MATH_PI/60,max:-MATH_PI/5},{cmd:ROTATE,theta:MATH_PI/150,max:MATH_PI/3},{cmd:TRANSLATE_TO_Y,t:1e3},{cmd:TELEPORT_TO_Y,t:-50}];var pattern_M3_A1_L=[{cmd:ROTATE,theta:MATH_PI/20,max:MATH_PI/.98},{cmd:TRANSLATE,frames:170},{cmd:ROTATE,theta:MATH_PI/32,max:MATH_PI/.5},{cmd:TRANSLATE,frames:70},{cmd:ROTATE,theta:MATH_PI/60,max:MATH_PI/5},{cmd:ROTATE,theta:-MATH_PI/150,max:-MATH_PI/3},{cmd:TRANSLATE_TO_Y,t:1e3},{cmd:TELEPORT_TO_Y,t:-50}];var pattern_M3_A2_R=[{cmd:ROTATE,theta:MATH_PI/60,max:MATH_PI/4},{cmd:ROTATE,theta:-MATH_PI/50,max:-MATH_PI/2},{cmd:TRANSLATE,frames:110},{cmd:ROTATE,theta:-MATH_PI/32,max:-MATH_PI/.5},{cmd:TRANSLATE,frames:200},{cmd:ROTATE,theta:MATH_PI/150,max:MATH_PI/3},{cmd:TRANSLATE_TO_Y,t:1e3},{cmd:TELEPORT_TO_Y,t:-50},{cmd:SHIFT_X,t:-15}];var pattern_M3_A2_L=[{cmd:ROTATE,theta:-MATH_PI/60,max:-MATH_PI/4},{cmd:ROTATE,theta:MATH_PI/50,max:MATH_PI/2},{cmd:TRANSLATE,frames:110},{cmd:ROTATE,theta:MATH_PI/32,max:MATH_PI/.5},{cmd:TRANSLATE,frames:200},{cmd:ROTATE,theta:-MATH_PI/150,max:-MATH_PI/3},{cmd:TRANSLATE_TO_Y,t:1e3},{cmd:TELEPORT_TO_Y,t:-50},{cmd:SHIFT_X,t:15}];var pattern_M3_A3_R=[{cmd:ROTATE,theta:-MATH_PI/20,max:-MATH_PI/.9},{cmd:TRANSLATE,frames:390},{cmd:TRANSLATE_TO_Y,t:1e3},{cmd:TELEPORT_TO_Y,t:-50}];var pattern_M3_A3_L=[{cmd:ROTATE,theta:MATH_PI/20,max:MATH_PI/.9},{cmd:TRANSLATE,frames:390},{cmd:TRANSLATE_TO_Y,t:1e3},{cmd:TELEPORT_TO_Y,t:-50}];PATTERNS.wayBack_L=new Array(pattern_BackL);PATTERNS.wayBack_R=new Array(pattern_BackR);PATTERNS.way1_R=new Array(pattern_1_R);PATTERNS.way1_L=new Array(pattern_1_L);PATTERNS.way2_R=new Array(pattern_2_R);PATTERNS.way2_L=new Array(pattern_2_L);PATTERNS.attack_M1_A1_R=new Array(pattern_M1_A1_R);PATTERNS.attack_M1_A2_R=new Array(pattern_M1_A2_R);PATTERNS.attack_M1_A1_L=new Array(pattern_M1_A1_L);PATTERNS.attack_M1_A2_L=new Array(pattern_M1_A2_L);PATTERNS.attack_M2_A1_R=new Array(pattern_M2_A1_R);PATTERNS.attack_M2_A2_R=new Array(pattern_M2_A2_R);PATTERNS.attack_M2_A1_L=new Array(pattern_M2_A1_L);PATTERNS.attack_M2_A2_L=new Array(pattern_M2_A2_L);PATTERNS.attack_M3_A1_R=new Array(pattern_M3_A1_R);PATTERNS.attack_M3_A2_R=new Array(pattern_M3_A2_R);PATTERNS.attack_M3_A3_R=new Array(pattern_M3_A3_R);PATTERNS.attack_M3_A1_L=new Array(pattern_M3_A1_L);PATTERNS.attack_M3_A2_L=new Array(pattern_M3_A2_L);PATTERNS.attack_M3_A3_L=new Array(pattern_M3_A3_L);