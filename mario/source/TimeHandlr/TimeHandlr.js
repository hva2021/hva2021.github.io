function TimeHandlr(e){"use strict";var t,n,r,c,a,i,l,s,o;this.getTime=function(){return t},this.getEvents=function(){return n};var u=this.addEvent=function(e,n){if(!(e instanceof Function))return!1;n=n||1;var r=y(arguments);r.splice(0,2);var c={func:e,time_exec:t+n,time_repeat:n,args:r,repeat:1};return d(c,c.time_exec),c},f=this.addEventInterval=function(e,n,r){if(!(e instanceof Function))return!1;n=n||1,r=r||1;var c=y(arguments);c.splice(0,3);var a={func:e,time_exec:t+n,time_repeat:n,args:c,repeat:r};return e.event=a,d(a,a.time_exec),a},v=this.addEventIntervalSynched=function(e,n,r,c,a){var i=n*a.length,l=_(t/i)*i,s=this,o=function(e,n,r){return r.startcount=t,f.apply(e,n)};if(n=n||1,r=r||1,l==t)return o(s,arguments,c);var v=l-t;u(o,v,s,arguments,c)};function d(e,t){return n[t]?(n[t].push(e),n[t]):n[t]=[e]}this.clearEvent=function(e){e&&(e.repeat=0)},this.clearAllEvents=function(){n={}};var p=this.clearClassCycle=function(e,t){if(e[r]&&e[r][t]){var n=e[r][t];n[0]=!1,n.length=!1,delete e[r][t]}};this.clearAllCycles=function(e){var t,n,r=e[r];for(t in r)(n=r[t])[0]=!1,n.length=1,delete r[t]},this.addSpriteCycle=function(e,t,n,c){e[r]||(e[r]={}),p(e,n);var a="function"==typeof c;n=n||0;var i=e[r][n]=h(e,t,a?0:c);return i.event&&a&&(i.event.count_changer=c),m(e,t),i},this.addSpriteCycleSynched=function(e,t,n,c){e[r]||(e[r]={}),p(e,n),n=n||0;var a=e[r][n]=h(e,t,c,!0);return m(e,t),a};function h(e,t,n,r){t.loc=t.oldclass=-1;var i=r?v:f;return e[c]=function(){i(m,n||l,1/0,e,t)},e[a]&&e[c](),t}function m(e,t){if(!e||!t||!t.length)return!0;if(null!=i&&!e[i])return!0;-1!=t.oldclass&&""!==t.oldclass&&o(e,t.oldclass),t.loc=++t.loc%t.length;var n=t[t.loc];if(n){var r=n instanceof Function?n(e,t):n;return"string"==typeof r?(t.oldclass=r,s(e,r),!1):!1===r}return!1===n}function y(e){return Array.prototype.slice.call(e)}function g(e,t){e.className+=" "+t}function C(e,t){e.className=e.className.replace(new RegExp(" "+t,"gm"),"")}this.handleEvents=function(){++t;var e=n[t];if(e){var r,c,a;for(a=0,c=e.length;a<c;++a)(r=e[a]).repeat>0&&!r.func.apply(this,r.args)&&(r.count_changer&&r.count_changer(r),r.repeat instanceof Function?r.repeat.bind(r)()&&(r.count+=r.time_repeat,d(r,r.time_exec)):--r.repeat>0&&(r.time_exec+=r.time_repeat,d(r,r.time_exec)));delete n[t]}};var _=Math.ceil;!function(e){t=e.time||0,n=e.events||{},r=e.cycles||"cycles",e.className||"className",c=e.onSpriteCycleStart||"onSpriteCycleStart",a=e.doSpriteCycleStart||"doSpriteCycleStart",i=e.cycleCheckValidity,l=e.timingDefault||7,s=e.addClass||window.addClass||g,o=e.removeClass||window.removeClass||C}(e||{})}